<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic regression · DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../example_independent_bernoulli/">Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li class="is-active"><a class="tocitem" href>Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Logistic regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_logistic_regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Logistic-regression"><a class="docs-heading-anchor" href="#Logistic-regression">Logistic regression</a><a id="Logistic-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-regression" title="Permalink"></a></h1><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra, StatsFuns, LogExpFunctions</code></pre><p>then diagnostic and benchmark tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, BenchmarkTools</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff

&quot;&quot;&quot;
Logistic regression.

For each draw, ``logit(Pr(yᵢ == 1)) ∼ Xᵢ β``. Uses a `β ∼ Normal(0, σ)` prior.

`X` is supposed to include the `1`s for the intercept.
&quot;&quot;&quot;
struct LogisticRegression{Ty, TX, Tσ}
    y::Ty
    X::TX
    σ::Tσ
end

function (problem::LogisticRegression)(θ)
    @unpack y, X, σ = problem
    @unpack β = θ
    ℓ_y = mapreduce((y, x) -&gt; logpdf(Bernoulli(logistic(dot(x, β))), y), +, y, eachrow(X))
    ℓ_β =  loglikelihood(Normal(0, σ), β)
    ℓ_y + ℓ_β
end</code></pre><p>Make up parameters, generate data using random draws.</p><pre><code class="language-julia hljs">N = 1000
β = [1.0, 2.0]
X = hcat(ones(N), randn(N))
y = rand.(Bernoulli.(logistic.(X*β)));</code></pre><p>Create a problem, apply a transformation, then use automatic differentiation.</p><pre><code class="language-julia hljs">p = LogisticRegression(y, X, 10.0)   # data and (vague) priors
t = as((β = as(Array, length(β)), )) # identity transformation, just to get the dimension
P = TransformedLogDensity(t, p)      # transformed
∇P = ADgradient(:ForwardDiff, P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ForwardDiff AD wrapper for TransformedLogDensity of dimension 2, w/ chunk size 2</code></pre><p>Benchmark</p><pre><code class="language-julia hljs">@btime p((β = $β,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-408.43464759127744</code></pre><p>Sample using NUTS, random starting point.</p><pre><code class="language-julia hljs">results = map(_ -&gt; mcmc_with_warmup(Random.default_rng(), ∇P, 1000), 1:5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :κ, :ϵ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [1.1984708792495915 1.0513483902364404 … 1.176251109397969 1.1108677751128173; 1.9456268505976784 2.072697960599086 … 2.017216844222952 1.8861911645723768], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-409.9156968632793, 2, turning at positions -3:0, 0.7740845493085439, 3, DynamicHMC.Directions(0xe0b74b20)), DynamicHMC.TreeStatisticsNUTS(-408.0067320441799, 2, turning at positions -2:-5, 0.9999999999999999, 7, DynamicHMC.Directions(0x9a9f6412)), DynamicHMC.TreeStatisticsNUTS(-408.5869919364353, 2, turning at positions -3:0, 0.9130463238871553, 3, DynamicHMC.Directions(0x30275110)), DynamicHMC.TreeStatisticsNUTS(-407.85975897889426, 2, turning at positions -2:-3, 0.9819756923916885, 5, DynamicHMC.Directions(0x88e79072)), DynamicHMC.TreeStatisticsNUTS(-408.4679274954609, 2, turning at positions -1:-4, 0.9761917869159573, 7, DynamicHMC.Directions(0xcb7698fb)), DynamicHMC.TreeStatisticsNUTS(-407.2072887593258, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x4a5946c1)), DynamicHMC.TreeStatisticsNUTS(-407.12218742072, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x4181a766)), DynamicHMC.TreeStatisticsNUTS(-406.89407860286747, 1, turning at positions -1:0, 0.9923208008712823, 1, DynamicHMC.Directions(0x98b01b18)), DynamicHMC.TreeStatisticsNUTS(-409.0450550465407, 2, turning at positions 0:3, 0.7365202701764407, 3, DynamicHMC.Directions(0x02b84a8b)), DynamicHMC.TreeStatisticsNUTS(-408.3853669207974, 2, turning at positions -3:0, 0.823997129298007, 3, DynamicHMC.Directions(0xe1a8d0c4))  …  DynamicHMC.TreeStatisticsNUTS(-407.104904882224, 2, turning at positions -3:0, 0.9502429524969709, 3, DynamicHMC.Directions(0xe585e0ec)), DynamicHMC.TreeStatisticsNUTS(-406.8335879952108, 1, turning at positions -1:-2, 0.9890672470697107, 3, DynamicHMC.Directions(0x9a624059)), DynamicHMC.TreeStatisticsNUTS(-407.5805761179073, 3, turning at positions -6:1, 0.9585115081099184, 7, DynamicHMC.Directions(0x9dc996d1)), DynamicHMC.TreeStatisticsNUTS(-410.5814444334795, 2, turning at positions -3:-6, 0.7074670508706424, 7, DynamicHMC.Directions(0xae7d36e1)), DynamicHMC.TreeStatisticsNUTS(-408.4122592896013, 2, turning at positions 0:3, 0.9999999999999999, 3, DynamicHMC.Directions(0xf147ab1b)), DynamicHMC.TreeStatisticsNUTS(-407.59619069203876, 2, turning at positions -1:2, 0.8600702931062467, 3, DynamicHMC.Directions(0xc146708a)), DynamicHMC.TreeStatisticsNUTS(-407.7256487508967, 3, turning at positions -1:6, 0.991791481299593, 7, DynamicHMC.Directions(0x2c0cea8e)), DynamicHMC.TreeStatisticsNUTS(-407.0659213775663, 2, turning at positions 1:4, 0.9999999999999999, 7, DynamicHMC.Directions(0xa52c4ba4)), DynamicHMC.TreeStatisticsNUTS(-406.92329368041226, 2, turning at positions -3:0, 0.995657857448275, 3, DynamicHMC.Directions(0x65c5328c)), DynamicHMC.TreeStatisticsNUTS(-408.6497313640214, 2, turning at positions 0:3, 0.8486658074304453, 3, DynamicHMC.Directions(0xe8b285cb))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.10375748180727574, 0.13409617807384633], ϵ = 0.7112732309023262)
 (posterior_matrix = [1.3764102183289908 1.2463275900181063 … 1.2230804372500625 1.2737469277082152; 2.1534718776314032 2.248031455881836 … 2.1923799172361123 2.165511128787718], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-409.61466161707415, 2, turning at positions -3:0, 0.9259235009789507, 3, DynamicHMC.Directions(0x7e41d6f8)), DynamicHMC.TreeStatisticsNUTS(-408.4588364009692, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xab9d876a)), DynamicHMC.TreeStatisticsNUTS(-407.8041249328081, 2, turning at positions 1:2, 0.9466043251558698, 5, DynamicHMC.Directions(0xfa52db54)), DynamicHMC.TreeStatisticsNUTS(-407.7696953385015, 2, turning at positions 0:3, 0.9619438919104658, 3, DynamicHMC.Directions(0x9fe1ae63)), DynamicHMC.TreeStatisticsNUTS(-407.5502701519735, 2, turning at positions -1:2, 0.9363302103313985, 3, DynamicHMC.Directions(0x61be4f4a)), DynamicHMC.TreeStatisticsNUTS(-407.47884934801016, 2, turning at positions 4:7, 0.9952808276644286, 7, DynamicHMC.Directions(0xb7e9afe7)), DynamicHMC.TreeStatisticsNUTS(-407.454244560446, 2, turning at positions 0:3, 0.9846979028336932, 3, DynamicHMC.Directions(0x4bfbcca7)), DynamicHMC.TreeStatisticsNUTS(-408.7371315598411, 2, turning at positions -2:1, 0.7588750941022319, 3, DynamicHMC.Directions(0xb5a26edd)), DynamicHMC.TreeStatisticsNUTS(-409.2122400331924, 2, turning at positions -2:-5, 0.9516059583731185, 7, DynamicHMC.Directions(0xc19e96e2)), DynamicHMC.TreeStatisticsNUTS(-410.92701869961587, 2, turning at positions -1:2, 0.9264152249628118, 3, DynamicHMC.Directions(0x173e4fba))  …  DynamicHMC.TreeStatisticsNUTS(-406.96645702853664, 3, turning at positions -3:4, 0.9999999999999999, 7, DynamicHMC.Directions(0xf8b3ca3c)), DynamicHMC.TreeStatisticsNUTS(-406.74480004730424, 2, turning at positions -3:0, 0.9982821477508464, 3, DynamicHMC.Directions(0x5cddaaec)), DynamicHMC.TreeStatisticsNUTS(-410.1932051598152, 1, turning at positions -1:-2, 0.4249435139306301, 3, DynamicHMC.Directions(0xbb203085)), DynamicHMC.TreeStatisticsNUTS(-407.6086549447468, 2, turning at positions -3:0, 0.8712570413234584, 3, DynamicHMC.Directions(0x15ac0978)), DynamicHMC.TreeStatisticsNUTS(-406.75969199917137, 2, turning at positions -4:-7, 0.9943043816818727, 7, DynamicHMC.Directions(0x5ffdd300)), DynamicHMC.TreeStatisticsNUTS(-407.50982900552714, 2, turning at positions 0:3, 0.8959691621790248, 3, DynamicHMC.Directions(0x1cb8b9c3)), DynamicHMC.TreeStatisticsNUTS(-410.00251078723124, 2, turning at positions -1:2, 0.8874753250975981, 3, DynamicHMC.Directions(0x929c0be6)), DynamicHMC.TreeStatisticsNUTS(-409.79165327597775, 3, turning at positions -3:4, 0.9745461439343187, 7, DynamicHMC.Directions(0x8bb6613c)), DynamicHMC.TreeStatisticsNUTS(-408.82515447896515, 3, turning at positions 0:7, 0.9835099348703604, 7, DynamicHMC.Directions(0x885ebf4f)), DynamicHMC.TreeStatisticsNUTS(-406.97684140081714, 3, turning at positions -5:2, 0.9808107968600644, 7, DynamicHMC.Directions(0xc3a009ba))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.10574242195213919, 0.14009280940020613], ϵ = 0.7104268298055293)
 (posterior_matrix = [1.28501182421055 1.1128142041651534 … 1.1913599014276075 1.316200587664871; 2.202422445889235 2.066523006000407 … 2.0754590838807365 2.232481418116451], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-407.49849457872807, 2, turning at positions -1:2, 0.973705539865935, 3, DynamicHMC.Directions(0x2724839e)), DynamicHMC.TreeStatisticsNUTS(-407.1479250087892, 3, turning at positions -4:3, 0.9955152515974163, 7, DynamicHMC.Directions(0x62047a63)), DynamicHMC.TreeStatisticsNUTS(-408.04965568802936, 3, turning at positions 0:7, 0.8355339531877715, 7, DynamicHMC.Directions(0xf4ad1167)), DynamicHMC.TreeStatisticsNUTS(-409.30792315218764, 2, turning at positions -2:1, 0.9069158892149373, 3, DynamicHMC.Directions(0x52f28801)), DynamicHMC.TreeStatisticsNUTS(-410.8989886801947, 2, turning at positions 0:3, 0.8782023368279613, 3, DynamicHMC.Directions(0xec597543)), DynamicHMC.TreeStatisticsNUTS(-411.345912580865, 1, turning at positions -2:-3, 0.8565062348098119, 3, DynamicHMC.Directions(0xdd68f3fc)), DynamicHMC.TreeStatisticsNUTS(-408.85334249796375, 1, turning at positions 2:3, 0.9244351391183115, 3, DynamicHMC.Directions(0x7fc9f2fb)), DynamicHMC.TreeStatisticsNUTS(-407.82858183830734, 1, turning at positions -2:-3, 0.9138473217622906, 3, DynamicHMC.Directions(0x3c7cd290)), DynamicHMC.TreeStatisticsNUTS(-407.6660645253297, 1, turning at positions 2:3, 0.9428796682450186, 3, DynamicHMC.Directions(0x6db6c633)), DynamicHMC.TreeStatisticsNUTS(-410.52272393135587, 2, turning at positions 0:3, 0.4487742611574849, 3, DynamicHMC.Directions(0xd38cd5eb))  …  DynamicHMC.TreeStatisticsNUTS(-409.99981789533274, 2, turning at positions -3:0, 0.7894275336073906, 3, DynamicHMC.Directions(0xfbc776b4)), DynamicHMC.TreeStatisticsNUTS(-407.8379763302157, 2, turning at positions 0:3, 0.9033928358716494, 3, DynamicHMC.Directions(0x4343c4bf)), DynamicHMC.TreeStatisticsNUTS(-409.95410715768827, 2, turning at positions -3:-4, 0.7246408699225362, 5, DynamicHMC.Directions(0x30b49a21)), DynamicHMC.TreeStatisticsNUTS(-411.11998637098503, 2, turning at positions -1:2, 0.3451670629737058, 3, DynamicHMC.Directions(0x438ce006)), DynamicHMC.TreeStatisticsNUTS(-409.14930667051834, 2, turning at positions -1:2, 0.8767120594212056, 3, DynamicHMC.Directions(0x6ec827e2)), DynamicHMC.TreeStatisticsNUTS(-408.194928698018, 2, turning at positions -1:2, 0.9246408989087135, 3, DynamicHMC.Directions(0x5857d7c2)), DynamicHMC.TreeStatisticsNUTS(-408.2048898797241, 2, turning at positions -4:-5, 0.9856071124699837, 5, DynamicHMC.Directions(0xc1a2edc0)), DynamicHMC.TreeStatisticsNUTS(-407.45657912458984, 1, turning at positions -1:0, 0.9546682899434233, 1, DynamicHMC.Directions(0xe1728f76)), DynamicHMC.TreeStatisticsNUTS(-407.4086546704949, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x2c822c65)), DynamicHMC.TreeStatisticsNUTS(-408.6906345793715, 2, turning at positions 2:5, 0.8765395185692818, 7, DynamicHMC.Directions(0x06f806d5))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.10113025603674412, 0.13961708035188714], ϵ = 0.8336974211987935)
 (posterior_matrix = [1.132814999761963 1.2838970828325715 … 1.1236533880323092 1.181330258144784; 2.222344166981482 2.1981381291479556 … 2.204655632939068 2.2247823306329155], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-408.25059997161196, 1, turning at positions -1:-2, 0.7834871134911424, 3, DynamicHMC.Directions(0x285d1335)), DynamicHMC.TreeStatisticsNUTS(-407.98738247949103, 3, turning at positions -6:1, 0.9711569028646606, 7, DynamicHMC.Directions(0x44460d29)), DynamicHMC.TreeStatisticsNUTS(-407.38331883409523, 2, turning at positions -3:0, 0.9819892216733388, 3, DynamicHMC.Directions(0xd9e04718)), DynamicHMC.TreeStatisticsNUTS(-407.0442371877241, 2, turning at positions -1:-4, 0.9982834047653932, 7, DynamicHMC.Directions(0x62f9baf3)), DynamicHMC.TreeStatisticsNUTS(-407.5734282617602, 2, turning at positions 0:3, 0.8886293317476205, 3, DynamicHMC.Directions(0x2b1d4593)), DynamicHMC.TreeStatisticsNUTS(-408.8521646658139, 2, turning at positions -3:0, 0.9563802074505348, 3, DynamicHMC.Directions(0x5acc13f8)), DynamicHMC.TreeStatisticsNUTS(-409.7727498551429, 2, turning at positions -3:0, 0.8863886418814032, 3, DynamicHMC.Directions(0x5635383c)), DynamicHMC.TreeStatisticsNUTS(-407.1286476619791, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xb76d9dea)), DynamicHMC.TreeStatisticsNUTS(-408.30990237395963, 3, turning at positions -6:1, 0.9019498749295227, 7, DynamicHMC.Directions(0x6c7138b1)), DynamicHMC.TreeStatisticsNUTS(-407.2862840037738, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x5bfefbd2))  …  DynamicHMC.TreeStatisticsNUTS(-408.3794592374577, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0xd30027f5)), DynamicHMC.TreeStatisticsNUTS(-410.41406762483456, 2, turning at positions 0:3, 0.8974313067310935, 3, DynamicHMC.Directions(0x81d5569b)), DynamicHMC.TreeStatisticsNUTS(-409.764913554565, 3, turning at positions -3:4, 0.9999999999999999, 7, DynamicHMC.Directions(0x1cfdeb74)), DynamicHMC.TreeStatisticsNUTS(-407.28510866390724, 2, turning at positions -3:0, 0.9805502468338546, 3, DynamicHMC.Directions(0x9248b634)), DynamicHMC.TreeStatisticsNUTS(-407.56402683725514, 2, turning at positions -4:-7, 0.9627413093016335, 7, DynamicHMC.Directions(0x1e7954b0)), DynamicHMC.TreeStatisticsNUTS(-407.92027818641105, 2, turning at positions -2:-5, 0.8779933960243456, 7, DynamicHMC.Directions(0xf911eea2)), DynamicHMC.TreeStatisticsNUTS(-408.86640753970977, 2, turning at positions 0:3, 0.902346678415201, 3, DynamicHMC.Directions(0x81e19ff7)), DynamicHMC.TreeStatisticsNUTS(-407.0577840863728, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xa33446ae)), DynamicHMC.TreeStatisticsNUTS(-407.6989830055803, 2, turning at positions -4:-7, 0.9568767633830789, 7, DynamicHMC.Directions(0xac0c3d48)), DynamicHMC.TreeStatisticsNUTS(-407.5567878207526, 2, turning at positions -2:-5, 0.9950819333030176, 7, DynamicHMC.Directions(0x8b53c2a2))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09257049114126374, 0.14399730330016], ϵ = 0.6983357742330045)
 (posterior_matrix = [1.1190759407458408 1.1686155706126293 … 1.1493799384081675 1.0601641492944225; 2.0949338507400426 2.0674343420769006 … 1.978943776812994 1.9361514306597958], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-409.63775156723545, 2, turning at positions 3:6, 0.9717676210617929, 7, DynamicHMC.Directions(0x90e21286)), DynamicHMC.TreeStatisticsNUTS(-406.82256286126363, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x4e52668a)), DynamicHMC.TreeStatisticsNUTS(-407.52354002679414, 2, turning at positions -3:0, 0.9289472018582218, 3, DynamicHMC.Directions(0x0a0d6ed8)), DynamicHMC.TreeStatisticsNUTS(-408.735671029199, 2, turning at positions -2:1, 0.7718791818751201, 3, DynamicHMC.Directions(0x9a0a2241)), DynamicHMC.TreeStatisticsNUTS(-407.7843348172741, 2, turning at positions 1:4, 0.9999999999999999, 7, DynamicHMC.Directions(0xe918f7e4)), DynamicHMC.TreeStatisticsNUTS(-407.1406355557606, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x4019f936)), DynamicHMC.TreeStatisticsNUTS(-409.1951771236035, 2, turning at positions 0:3, 0.7155380715466232, 3, DynamicHMC.Directions(0xd09d1b47)), DynamicHMC.TreeStatisticsNUTS(-408.910310606821, 2, turning at positions -3:0, 0.984790753915572, 3, DynamicHMC.Directions(0x4927d12c)), DynamicHMC.TreeStatisticsNUTS(-408.60854144328727, 2, turning at positions -3:0, 0.9999999999999999, 3, DynamicHMC.Directions(0x438c863c)), DynamicHMC.TreeStatisticsNUTS(-407.9453758883273, 2, turning at positions 0:3, 0.8649101618928449, 3, DynamicHMC.Directions(0x4e7c4783))  …  DynamicHMC.TreeStatisticsNUTS(-408.54441414440714, 3, turning at positions -7:0, 0.9891393464289819, 7, DynamicHMC.Directions(0x2079c050)), DynamicHMC.TreeStatisticsNUTS(-408.65250592433966, 2, turning at positions -2:1, 0.9851749016940926, 3, DynamicHMC.Directions(0xb5e61e95)), DynamicHMC.TreeStatisticsNUTS(-406.9661588755783, 1, turning at positions 2:3, 0.9771154860086634, 3, DynamicHMC.Directions(0x64667d43)), DynamicHMC.TreeStatisticsNUTS(-407.58402289715156, 2, turning at positions -3:-6, 0.9268855716813235, 7, DynamicHMC.Directions(0xf53906d1)), DynamicHMC.TreeStatisticsNUTS(-407.3430875769966, 1, turning at positions -1:0, 0.9234307821148026, 1, DynamicHMC.Directions(0x1685c876)), DynamicHMC.TreeStatisticsNUTS(-407.67183041439563, 3, turning at positions -7:0, 0.9950496996025402, 7, DynamicHMC.Directions(0x56315158)), DynamicHMC.TreeStatisticsNUTS(-407.491336888569, 2, turning at positions 2:3, 0.9925949244923007, 5, DynamicHMC.Directions(0xbe4cd57d)), DynamicHMC.TreeStatisticsNUTS(-408.53858447471146, 1, turning at positions -1:-2, 0.799469040454972, 3, DynamicHMC.Directions(0x5650f191)), DynamicHMC.TreeStatisticsNUTS(-408.9421143561955, 1, turning at positions 2:3, 0.9606597754702828, 3, DynamicHMC.Directions(0x554a0a27)), DynamicHMC.TreeStatisticsNUTS(-408.2221702570632, 2, turning at positions -1:2, 0.9591255042854967, 3, DynamicHMC.Directions(0x4354cd9a))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.10480809070864053, 0.14669592519451943], ϵ = 0.6838781302316126)</code></pre><p>Extract the posterior. (Here the transformation was not really necessary).</p><pre><code class="language-julia hljs">β_posterior = first.(transform.(t, eachcol(pool_posterior_matrices(results))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5000-element Vector{Vector{Float64}}:
 [1.1984708792495915, 1.9456268505976784]
 [1.0513483902364404, 2.072697960599086]
 [1.2726342423153991, 2.107356556562491]
 [1.3199200536726932, 2.189547533374234]
 [1.086997501658068, 2.0060350999140795]
 [1.0955944323316136, 2.0101044942637243]
 [1.1242896233692272, 2.0505521708016134]
 [1.1149113832779238, 2.04225511356254]
 [1.1828836292391267, 2.0979440713674364]
 [1.0277061332715969, 2.1070143525097706]
 ⋮
 [1.1856656940271786, 2.134691278995707]
 [1.141492868039914, 2.0737588965271994]
 [1.1603616474259895, 2.205025644520281]
 [1.1393988283068086, 2.224121288424889]
 [1.1521574936713033, 2.241160855761747]
 [1.2856087541930754, 2.1905105235829425]
 [1.2829360725891552, 2.0322164200597177]
 [1.1493799384081675, 1.978943776812994]
 [1.0601641492944225, 1.9361514306597958]</code></pre><p>Check that we recover the parameters.</p><pre><code class="language-julia hljs">mean(β_posterior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.191836385555681
 2.128511235446258</code></pre><p>Quantiles</p><pre><code class="language-julia hljs">qs = [0.05, 0.25, 0.5, 0.75, 0.95]
quantile(first.(β_posterior), qs)

quantile(last.(β_posterior), qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.8972694210991237
 2.036087768168385
 2.1268782236008015
 2.2215033588360384
 2.3615753001148794</code></pre><p>Check that mixing is good.</p><pre><code class="language-julia hljs">ess, R̂ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([2551.089669451217, 2411.267269907978], [1.0015369745666218, 1.0001094382628686])</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_linear_regression/">« Linear regression</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 8 December 2022 01:23">Thursday 8 December 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
