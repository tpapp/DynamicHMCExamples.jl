<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic regression · DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../example_independent_bernoulli/">Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li class="is-active"><a class="tocitem" href>Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Logistic regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_logistic_regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Logistic-regression"><a class="docs-heading-anchor" href="#Logistic-regression">Logistic regression</a><a id="Logistic-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-regression" title="Permalink"></a></h1><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, LogDensityProblemsAD,
    DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra, StatsFuns, LogExpFunctions</code></pre><p>then diagnostic and benchmark tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, BenchmarkTools</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff

&quot;&quot;&quot;
Logistic regression.

For each draw, ``logit(Pr(yᵢ == 1)) ∼ Xᵢ β``. Uses a `β ∼ Normal(0, σ)` prior.

`X` is supposed to include the `1`s for the intercept.
&quot;&quot;&quot;
struct LogisticRegression{Ty, TX, Tσ}
    y::Ty
    X::TX
    σ::Tσ
end

function (problem::LogisticRegression)(θ)
    @unpack y, X, σ = problem
    @unpack β = θ
    ℓ_y = mapreduce((y, x) -&gt; logpdf(Bernoulli(logistic(dot(x, β))), y), +, y, eachrow(X))
    ℓ_β =  loglikelihood(Normal(0, σ), β)
    ℓ_y + ℓ_β
end</code></pre><p>Make up parameters, generate data using random draws.</p><pre><code class="language-julia hljs">N = 1000
β = [1.0, 2.0]
X = hcat(ones(N), randn(N))
y = rand.(Bernoulli.(logistic.(X*β)));</code></pre><p>Create a problem, apply a transformation, then use automatic differentiation.</p><pre><code class="language-julia hljs">p = LogisticRegression(y, X, 10.0)   # data and (vague) priors
t = as((β = as(Array, length(β)), )) # identity transformation, just to get the dimension
P = TransformedLogDensity(t, p)      # transformed
∇P = ADgradient(:ForwardDiff, P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ForwardDiff AD wrapper for TransformedLogDensity of dimension 2, w/ chunk size 2</code></pre><p>Benchmark</p><pre><code class="language-julia hljs">@btime p((β = $β,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-456.1448112368288</code></pre><p>Sample using NUTS, random starting point.</p><pre><code class="language-julia hljs">results = map(_ -&gt; mcmc_with_warmup(Random.default_rng(), ∇P, 1000), 1:5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :κ, :ϵ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [0.7980477181448302 0.9454423565030459 … 0.7082307422852534 0.8774583767696748; 1.9798847097440049 1.847144814212674 … 1.8442331660539 1.6785415801811432], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-462.2071142884267, 2, turning at positions -3:0, 0.6064806036078183, 3, DynamicHMC.Directions(0x636b0ff0)), DynamicHMC.TreeStatisticsNUTS(-457.8567351050214, 1, turning at positions -2:-3, 0.931229121192198, 3, DynamicHMC.Directions(0xdc7417e8)), DynamicHMC.TreeStatisticsNUTS(-456.9862550218083, 1, turning at positions -1:-2, 0.6978376031300716, 3, DynamicHMC.Directions(0x81dd9541)), DynamicHMC.TreeStatisticsNUTS(-457.344338271674, 2, turning at positions 0:3, 0.7818234226944923, 3, DynamicHMC.Directions(0xc73f37e7)), DynamicHMC.TreeStatisticsNUTS(-457.3368631340744, 2, turning at positions -1:2, 0.886217482697215, 3, DynamicHMC.Directions(0xeac2645a)), DynamicHMC.TreeStatisticsNUTS(-457.1252486978296, 2, turning at positions -3:0, 0.9999999999999999, 3, DynamicHMC.Directions(0xb0ffbf34)), DynamicHMC.TreeStatisticsNUTS(-456.68454871037693, 2, turning at positions -2:1, 0.8825621771010174, 3, DynamicHMC.Directions(0xae8904fd)), DynamicHMC.TreeStatisticsNUTS(-455.9496826808224, 1, turning at positions -2:-3, 0.9786329686884131, 3, DynamicHMC.Directions(0xfc084c98)), DynamicHMC.TreeStatisticsNUTS(-455.34617518264224, 1, turning at positions 2:3, 0.9984835161680566, 3, DynamicHMC.Directions(0xe6a51f0f)), DynamicHMC.TreeStatisticsNUTS(-456.0469971581884, 2, turning at positions -3:0, 0.9347252793408859, 3, DynamicHMC.Directions(0xa77fc23c))  …  DynamicHMC.TreeStatisticsNUTS(-457.5967176310256, 2, turning at positions -1:-4, 0.9702554709334065, 7, DynamicHMC.Directions(0x72d29a6b)), DynamicHMC.TreeStatisticsNUTS(-458.1889955442806, 1, turning at positions 0:1, 0.8728530371550764, 1, DynamicHMC.Directions(0xb579861d)), DynamicHMC.TreeStatisticsNUTS(-458.1510808354257, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0xf286ed69)), DynamicHMC.TreeStatisticsNUTS(-455.8664777763472, 2, turning at positions -3:0, 0.9765995509813252, 3, DynamicHMC.Directions(0x1a69f46c)), DynamicHMC.TreeStatisticsNUTS(-456.48818754934337, 2, turning at positions -2:1, 0.8798665062036513, 3, DynamicHMC.Directions(0xd438daad)), DynamicHMC.TreeStatisticsNUTS(-456.7748033917252, 3, turning at positions -7:0, 0.9349735216311027, 7, DynamicHMC.Directions(0x1f588108)), DynamicHMC.TreeStatisticsNUTS(-457.70072807608136, 2, turning at positions -1:2, 0.7744758325888429, 3, DynamicHMC.Directions(0x6f88408a)), DynamicHMC.TreeStatisticsNUTS(-457.2460842897389, 2, turning at positions -3:0, 0.9300579176206843, 3, DynamicHMC.Directions(0x107a7708)), DynamicHMC.TreeStatisticsNUTS(-460.332039288579, 2, turning at positions 0:3, 0.810255351820132, 3, DynamicHMC.Directions(0xe7df4507)), DynamicHMC.TreeStatisticsNUTS(-459.44074215640904, 2, turning at positions -2:1, 0.7966763475505463, 3, DynamicHMC.Directions(0x1fd02c45))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09147003117244223, 0.12139124553724984], ϵ = 0.807790092011424)
 (posterior_matrix = [0.8879200724303073 0.8375574801153646 … 0.9647340566550251 0.8449994817932589; 1.8365129045539608 1.7872001587173725 … 1.8575028189936922 1.8351633388874578], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-455.675538248651, 3, turning at positions -4:3, 0.95729677995089, 7, DynamicHMC.Directions(0x957c21e3)), DynamicHMC.TreeStatisticsNUTS(-455.80043552742376, 2, turning at positions -2:1, 0.9495482047915446, 3, DynamicHMC.Directions(0xe8faaa6d)), DynamicHMC.TreeStatisticsNUTS(-455.7745606396845, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x24fa839e)), DynamicHMC.TreeStatisticsNUTS(-455.6540385474122, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x5ca3b5a4)), DynamicHMC.TreeStatisticsNUTS(-459.2431071938651, 2, turning at positions 0:3, 0.6888458832106347, 3, DynamicHMC.Directions(0xf487589f)), DynamicHMC.TreeStatisticsNUTS(-459.1658435963501, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x99f5798a)), DynamicHMC.TreeStatisticsNUTS(-457.7740825280136, 2, turning at positions 0:3, 0.8932041185431506, 3, DynamicHMC.Directions(0x4c4aa2db)), DynamicHMC.TreeStatisticsNUTS(-456.9838055659138, 3, turning at positions 0:7, 0.9286302137948201, 7, DynamicHMC.Directions(0x5f8939af)), DynamicHMC.TreeStatisticsNUTS(-456.7523731888085, 1, turning at positions -1:0, 0.9857419640793996, 1, DynamicHMC.Directions(0x92739d82)), DynamicHMC.TreeStatisticsNUTS(-457.17508324179374, 2, turning at positions 1:4, 0.9887748746191342, 7, DynamicHMC.Directions(0xf3db1ee4))  …  DynamicHMC.TreeStatisticsNUTS(-456.9102116036687, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0xfa7274c2)), DynamicHMC.TreeStatisticsNUTS(-456.9604079111268, 3, turning at positions -3:4, 0.9895503683482911, 7, DynamicHMC.Directions(0xb2e6ba1c)), DynamicHMC.TreeStatisticsNUTS(-457.16588456072844, 3, turning at positions -3:4, 0.984052527367887, 7, DynamicHMC.Directions(0x1e9afef4)), DynamicHMC.TreeStatisticsNUTS(-457.8321370302796, 2, turning at positions 0:3, 0.9673394339450746, 3, DynamicHMC.Directions(0xa8ee0d03)), DynamicHMC.TreeStatisticsNUTS(-458.12981252764956, 2, turning at positions -1:2, 0.9762812665219874, 3, DynamicHMC.Directions(0x5cfb01de)), DynamicHMC.TreeStatisticsNUTS(-456.62053635240375, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xcc6734d2)), DynamicHMC.TreeStatisticsNUTS(-458.792391581168, 2, turning at positions -1:-2, 0.6340575459676115, 5, DynamicHMC.Directions(0x5e91d9fb)), DynamicHMC.TreeStatisticsNUTS(-458.32025197796776, 2, turning at positions -2:1, 0.8907405858918477, 3, DynamicHMC.Directions(0x412d9c61)), DynamicHMC.TreeStatisticsNUTS(-456.62850623702127, 2, turning at positions 0:3, 0.9910069355971652, 3, DynamicHMC.Directions(0xe94ba813)), DynamicHMC.TreeStatisticsNUTS(-457.20998469577756, 2, turning at positions -3:0, 0.7797190810845681, 3, DynamicHMC.Directions(0xf83af738))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09632437918718328, 0.12152676725117627], ϵ = 0.7792634304112442)
 (posterior_matrix = [0.9674896530766308 0.8591991539994424 … 0.7774976401040089 0.8045964527423822; 1.8145413317992938 1.9456081837477872 … 1.7150910883458885 1.7702914571289023], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-457.36501081513666, 3, turning at positions -2:5, 0.9881935967885428, 7, DynamicHMC.Directions(0x6d83553d)), DynamicHMC.TreeStatisticsNUTS(-457.7700600153709, 2, turning at positions 2:5, 0.7727648231054068, 7, DynamicHMC.Directions(0x137e261d)), DynamicHMC.TreeStatisticsNUTS(-456.66200880627946, 2, turning at positions -2:1, 0.9611368914548412, 3, DynamicHMC.Directions(0x58369e59)), DynamicHMC.TreeStatisticsNUTS(-455.8935057329957, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x6994f465)), DynamicHMC.TreeStatisticsNUTS(-457.53260264765004, 2, turning at positions -1:2, 0.8827305453555817, 3, DynamicHMC.Directions(0x40d83c6e)), DynamicHMC.TreeStatisticsNUTS(-456.94819844334563, 3, turning at positions -7:0, 0.9989111397358549, 7, DynamicHMC.Directions(0x5bc98588)), DynamicHMC.TreeStatisticsNUTS(-457.2709806781205, 3, turning at positions -1:6, 0.8971235765814234, 7, DynamicHMC.Directions(0xff6be9fe)), DynamicHMC.TreeStatisticsNUTS(-464.3891643194059, 2, turning at positions 0:3, 0.5170323600950065, 3, DynamicHMC.Directions(0x6ec4c4df)), DynamicHMC.TreeStatisticsNUTS(-466.29771696495914, 2, turning at positions 3:4, 0.9053634016698402, 5, DynamicHMC.Directions(0x5793ddbe)), DynamicHMC.TreeStatisticsNUTS(-456.7132845176752, 3, turning at positions -3:4, 0.9830347835521979, 7, DynamicHMC.Directions(0x60d02f64))  …  DynamicHMC.TreeStatisticsNUTS(-456.62574781706434, 2, turning at positions -1:-4, 0.9886109468079063, 7, DynamicHMC.Directions(0xc863a623)), DynamicHMC.TreeStatisticsNUTS(-459.3168788801631, 3, turning at positions 0:7, 0.8544874934817865, 7, DynamicHMC.Directions(0xaa164177)), DynamicHMC.TreeStatisticsNUTS(-456.34924545601143, 2, turning at positions 0:3, 0.9999999999999999, 3, DynamicHMC.Directions(0xf8ec0ca3)), DynamicHMC.TreeStatisticsNUTS(-455.92529348446084, 2, turning at positions -3:-4, 0.9950147064215751, 7, DynamicHMC.Directions(0x5211788b)), DynamicHMC.TreeStatisticsNUTS(-456.790350802005, 2, turning at positions -3:-4, 0.9424310793100725, 5, DynamicHMC.Directions(0xdd2fcb49)), DynamicHMC.TreeStatisticsNUTS(-455.39779011392426, 2, turning at positions -2:1, 0.9981928965659362, 3, DynamicHMC.Directions(0x871df5e1)), DynamicHMC.TreeStatisticsNUTS(-455.4337336015758, 2, turning at positions 0:3, 0.9962064768013343, 3, DynamicHMC.Directions(0x9a418a8b)), DynamicHMC.TreeStatisticsNUTS(-455.63037988720583, 1, turning at positions -1:-2, 0.9698945336111806, 3, DynamicHMC.Directions(0xa8b947e5)), DynamicHMC.TreeStatisticsNUTS(-458.7171731660897, 1, turning at positions 2:3, 0.8064208255947013, 3, DynamicHMC.Directions(0x58bf194b)), DynamicHMC.TreeStatisticsNUTS(-456.7400334269114, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x51e104c6))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08317882081454873, 0.12224211043301214], ϵ = 0.7128992779728666)
 (posterior_matrix = [0.9921910433579311 0.9954810461472966 … 0.9451938746134045 0.8811535560264389; 2.0396068108444956 1.8770779239682853 … 1.7648970747397068 1.792893889306565], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-457.2916042726056, 2, turning at positions -3:0, 0.966559988030021, 3, DynamicHMC.Directions(0x6653f8dc)), DynamicHMC.TreeStatisticsNUTS(-456.5044395155953, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xe3ad71a2)), DynamicHMC.TreeStatisticsNUTS(-456.67286191987847, 2, turning at positions -2:1, 0.9110514840314718, 3, DynamicHMC.Directions(0xa14c6c3d)), DynamicHMC.TreeStatisticsNUTS(-456.04160403614054, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xc603064a)), DynamicHMC.TreeStatisticsNUTS(-455.8106175866656, 2, turning at positions -2:-5, 0.9760670445311349, 7, DynamicHMC.Directions(0x38bc47c2)), DynamicHMC.TreeStatisticsNUTS(-457.30221077681495, 3, turning at positions -6:1, 0.9425295679494617, 7, DynamicHMC.Directions(0x756c5ff9)), DynamicHMC.TreeStatisticsNUTS(-456.98490517181835, 2, turning at positions 2:3, 0.933592076818911, 5, DynamicHMC.Directions(0xbb56a61d)), DynamicHMC.TreeStatisticsNUTS(-455.76961531511614, 2, turning at positions -2:1, 0.9838091612808881, 3, DynamicHMC.Directions(0x758c4e7d)), DynamicHMC.TreeStatisticsNUTS(-455.6853598339522, 2, turning at positions -3:0, 0.9980478586830038, 3, DynamicHMC.Directions(0x6cdc0384)), DynamicHMC.TreeStatisticsNUTS(-455.392928151032, 2, turning at positions 3:4, 0.9955013750246768, 5, DynamicHMC.Directions(0xe65cdd16))  …  DynamicHMC.TreeStatisticsNUTS(-457.4943595524052, 1, turning at positions 1:2, 0.9307877923926168, 3, DynamicHMC.Directions(0x7bf9ca5a)), DynamicHMC.TreeStatisticsNUTS(-457.54872749806975, 3, turning at positions 0:7, 0.890164531068917, 7, DynamicHMC.Directions(0xcd4fc527)), DynamicHMC.TreeStatisticsNUTS(-457.9661931970363, 3, turning at positions 0:7, 0.960159427175957, 7, DynamicHMC.Directions(0x119b0eff)), DynamicHMC.TreeStatisticsNUTS(-457.05968698236063, 2, turning at positions -3:-6, 0.9245456163969742, 7, DynamicHMC.Directions(0x6f659589)), DynamicHMC.TreeStatisticsNUTS(-456.75213848361915, 2, turning at positions 0:3, 0.9830394181280804, 3, DynamicHMC.Directions(0xa922a4db)), DynamicHMC.TreeStatisticsNUTS(-456.5009219885282, 2, turning at positions -3:0, 0.9158278999781846, 3, DynamicHMC.Directions(0x0378d3c0)), DynamicHMC.TreeStatisticsNUTS(-456.242648874928, 1, turning at positions 1:2, 0.8781046802091755, 3, DynamicHMC.Directions(0x16190436)), DynamicHMC.TreeStatisticsNUTS(-457.0884783709441, 1, turning at positions 2:3, 0.8949099004487646, 3, DynamicHMC.Directions(0xa86118db)), DynamicHMC.TreeStatisticsNUTS(-455.8427459935332, 2, turning at positions -3:-6, 0.980911596737109, 7, DynamicHMC.Directions(0x13830939)), DynamicHMC.TreeStatisticsNUTS(-458.7799005663097, 2, turning at positions 0:3, 0.7185008858573295, 3, DynamicHMC.Directions(0x46c98a97))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08589120011304492, 0.12475280034222708], ϵ = 0.7000789085577769)
 (posterior_matrix = [0.8207087937554023 0.9543116177049694 … 0.8766423955049146 0.9324754193333465; 1.7346090703217234 1.857237249869367 … 1.6828674284167637 1.761198278683785], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-457.64868067732306, 3, turning at positions -6:1, 0.917460344613162, 7, DynamicHMC.Directions(0x3fb9f4b1)), DynamicHMC.TreeStatisticsNUTS(-457.1622694480935, 2, turning at positions 0:3, 0.8771774143877008, 3, DynamicHMC.Directions(0x4aa874bf)), DynamicHMC.TreeStatisticsNUTS(-455.41366677223226, 3, turning at positions -7:0, 0.9998739001114506, 7, DynamicHMC.Directions(0xeb8ef190)), DynamicHMC.TreeStatisticsNUTS(-455.508341991703, 2, turning at positions -3:0, 0.9991746478157641, 3, DynamicHMC.Directions(0xffce45d4)), DynamicHMC.TreeStatisticsNUTS(-455.97917193835667, 2, turning at positions -2:1, 0.9198993905005729, 3, DynamicHMC.Directions(0x316f0291)), DynamicHMC.TreeStatisticsNUTS(-458.6563163252761, 2, turning at positions -3:0, 0.8122731327112955, 3, DynamicHMC.Directions(0xa30b2078)), DynamicHMC.TreeStatisticsNUTS(-457.93473856517335, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xc5f763ca)), DynamicHMC.TreeStatisticsNUTS(-456.3718229611197, 2, turning at positions 3:6, 0.9965132359943133, 7, DynamicHMC.Directions(0x0aa7f73e)), DynamicHMC.TreeStatisticsNUTS(-456.9646708660289, 2, turning at positions -1:2, 0.9337364473061208, 3, DynamicHMC.Directions(0x074dc6a6)), DynamicHMC.TreeStatisticsNUTS(-461.2204480690071, 2, turning at positions -1:2, 0.558394825827608, 3, DynamicHMC.Directions(0x4856065e))  …  DynamicHMC.TreeStatisticsNUTS(-462.73680765540564, 2, turning at positions 0:3, 0.6797098478640199, 3, DynamicHMC.Directions(0x09236dc3)), DynamicHMC.TreeStatisticsNUTS(-460.351640561189, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x0ed8763d)), DynamicHMC.TreeStatisticsNUTS(-457.1063252200817, 1, turning at positions -2:-3, 0.8698845448348647, 3, DynamicHMC.Directions(0xeeef6e50)), DynamicHMC.TreeStatisticsNUTS(-457.7414986673631, 2, turning at positions 3:6, 0.8916691579619084, 7, DynamicHMC.Directions(0x458e876e)), DynamicHMC.TreeStatisticsNUTS(-457.59465233987504, 2, turning at positions -3:0, 0.9654181103253018, 3, DynamicHMC.Directions(0x2abff008)), DynamicHMC.TreeStatisticsNUTS(-457.1750728836761, 2, turning at positions 4:7, 0.9612669916103621, 7, DynamicHMC.Directions(0x4da5c747)), DynamicHMC.TreeStatisticsNUTS(-457.28172536030087, 2, turning at positions -3:0, 0.9679315053529193, 3, DynamicHMC.Directions(0x495a90dc)), DynamicHMC.TreeStatisticsNUTS(-458.0557945351849, 2, turning at positions -1:2, 0.8644347883893153, 3, DynamicHMC.Directions(0x5362794e)), DynamicHMC.TreeStatisticsNUTS(-457.2281330099656, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xeeaed4fa)), DynamicHMC.TreeStatisticsNUTS(-456.81216464917395, 2, turning at positions -3:0, 0.9456264411581428, 3, DynamicHMC.Directions(0x4f48b384))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08061856017069322, 0.11534053202812206], ϵ = 0.8146868884329419)</code></pre><p>Extract the posterior. (Here the transformation was not really necessary).</p><pre><code class="language-julia hljs">β_posterior = first.(transform.(t, eachcol(pool_posterior_matrices(results))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5000-element Vector{Vector{Float64}}:
 [0.7980477181448302, 1.9798847097440049]
 [0.9454423565030459, 1.847144814212674]
 [0.9454423565030459, 1.847144814212674]
 [0.976494896864516, 2.005210509582725]
 [1.0767148116075516, 1.9940827819258742]
 [0.8470061839474672, 1.862666912484893]
 [0.8598511964299702, 1.9187162064932173]
 [0.9337400022180897, 1.8474405933061964]
 [0.9147267658452588, 1.8303616500545554]
 [1.0089770371569287, 1.955999636077923]
 ⋮
 [0.9292100410479485, 1.9347867869112534]
 [1.0423121877577817, 1.9447811787708027]
 [0.8174925702170873, 1.9680680127848436]
 [1.055785909921987, 1.9173455899287453]
 [0.8476392485542644, 1.9371492501404783]
 [0.8118916323866755, 1.6711946772289081]
 [0.8936563696832456, 1.6030449290011402]
 [0.8766423955049146, 1.6828674284167637]
 [0.9324754193333465, 1.761198278683785]</code></pre><p>Check that we recover the parameters.</p><pre><code class="language-julia hljs">mean(β_posterior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.9189905715002704
 1.8582396002145476</code></pre><p>Quantiles</p><pre><code class="language-julia hljs">qs = [0.05, 0.25, 0.5, 0.75, 0.95]
quantile(first.(β_posterior), qs)

quantile(last.(β_posterior), qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.652225758151777
 1.7687929721381672
 1.8552643942128961
 1.9427187396407244
 2.074513948326447</code></pre><p>Check that mixing is good.</p><pre><code class="language-julia hljs">ess, R̂ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([4.168516058343366, 4.19131351605459, 4.173474470520885, 4.185412811435574, 4.191465592228903], [5.195212115208377, 4.875389613346474, 5.1102525509596655, 4.963370391231879, 4.88276074606499])</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_linear_regression/">« Linear regression</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 13 December 2022 01:26">Tuesday 13 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
