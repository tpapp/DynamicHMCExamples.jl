<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Estimate Bernoulli draws probabilility ¬∑ DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li class="is-active"><a class="tocitem" href>Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li><a class="tocitem" href="../example_logistic_regression/">Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Estimate Bernoulli draws probabilility</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Estimate Bernoulli draws probabilility</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_independent_bernoulli.jl" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Estimate-Bernoulli-draws-probabilility"><a class="docs-heading-anchor" href="#Estimate-Bernoulli-draws-probabilility">Estimate Bernoulli draws probabilility</a><a id="Estimate-Bernoulli-draws-probabilility-1"></a><a class="docs-heading-anchor-permalink" href="#Estimate-Bernoulli-draws-probabilility" title="Permalink"></a></h1><p>We estimate a simple model of <span>$n$</span> independent Bernoulli draws, with probability <span>$Œ±$</span>. First, we load the packages we use.</p><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra</code></pre><p>then diagnostic tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, DynamicHMC.Diagnostics</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff</code></pre><p>Then define a structure to hold the data. For this model, the number of draws equal to <code>1</code> is a sufficient statistic.</p><pre><code class="language-julia hljs">&quot;&quot;&quot;
Toy problem using a Bernoulli distribution.

We model `n` independent draws from a ``Bernoulli(Œ±)`` distribution.
&quot;&quot;&quot;
struct BernoulliProblem
    &quot;Total number of draws in the data.&quot;
    n::Int
    &quot;Number of draws `==1` in the data&quot;
    s::Int
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.BernoulliProblem</code></pre><p>Then make the type callable with the parameters <em>as a single argument</em>.  We use decomposition in the arguments, but it could be done inside the function, too.</p><pre><code class="language-julia hljs">function (problem::BernoulliProblem)(Œ∏)
    @unpack Œ± = Œ∏               # extract the parameters
    @unpack n, s = problem      # extract the data
    # log likelihood: the constant log(combinations(n, s)) term
    # has been dropped since it is irrelevant for posterior sampling.
    s * log(Œ±) + (n-s) * log(1-Œ±)
end</code></pre><p>We should test this, also, this would be a good place to benchmark and optimize more complicated problems.</p><pre><code class="language-julia hljs">p = BernoulliProblem(20, 10)
p((Œ± = 0.5, ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-13.862943611198906</code></pre><p>Recall that we need to</p><ol><li><p>transform from <span>$‚Ñù$</span> to the valid parameter domain <code>(0,1)</code> for more efficient sampling, and</p></li><li><p>calculate the derivatives for this transformed mapping.</p></li></ol><p>The helper packages <code>TransformVariables</code> and <code>LogDensityProblems</code> take care of this. We use a flat prior.</p><pre><code class="language-julia hljs">t = as((Œ± = asùïÄ,))
P = TransformedLogDensity(t, p)
‚àáP = ADgradient(:ForwardDiff, P);</code></pre><p>Finally, we sample from the posterior. The returned value the posterior matrix, diagnostic information, and the tuned sampler which would allow continuation of sampling.</p><pre><code class="language-julia hljs">results = [mcmc_with_warmup(Random.default_rng(), ‚àáP, 1000) for _ in 1:5]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :Œ∫, :œµ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [-0.22525551508453467 -0.4398278261030276 ‚Ä¶ 0.4727709082580198 0.08893155395531377], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-15.804410089617823, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x59bae779)), DynamicHMC.TreeStatisticsNUTS(-15.781530114989861, 1, turning at positions 0:1, 0.8927026390156843, 1, DynamicHMC.Directions(0x15465f29)), DynamicHMC.TreeStatisticsNUTS(-15.676928805102538, 1, turning at positions -2:-3, 0.9999999999999999, 3, DynamicHMC.Directions(0xdcb53120)), DynamicHMC.TreeStatisticsNUTS(-16.972340825510845, 2, turning at positions -3:0, 0.7115396488768696, 3, DynamicHMC.Directions(0x969d2714)), DynamicHMC.TreeStatisticsNUTS(-15.385403894085815, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xcc938372)), DynamicHMC.TreeStatisticsNUTS(-15.289463059428595, 2, turning at positions -1:2, 0.998470559998414, 3, DynamicHMC.Directions(0xe90d551a)), DynamicHMC.TreeStatisticsNUTS(-15.278014503175314, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x77b6910e)), DynamicHMC.TreeStatisticsNUTS(-15.568664042512065, 1, turning at positions 1:2, 0.9142968854945197, 3, DynamicHMC.Directions(0x335da206)), DynamicHMC.TreeStatisticsNUTS(-15.74506781126371, 2, turning at positions -3:0, 0.9277319946528455, 3, DynamicHMC.Directions(0x446c7fc0)), DynamicHMC.TreeStatisticsNUTS(-15.817420547057718, 1, turning at positions -1:0, 0.9709742671939671, 1, DynamicHMC.Directions(0xcc8a882e))  ‚Ä¶  DynamicHMC.TreeStatisticsNUTS(-15.774314001321093, 2, turning at positions 0:3, 0.9540331504675175, 3, DynamicHMC.Directions(0xdc39fbb3)), DynamicHMC.TreeStatisticsNUTS(-19.44291119566808, 2, turning at positions 0:3, 0.5989033790531996, 3, DynamicHMC.Directions(0xfdbcf8eb)), DynamicHMC.TreeStatisticsNUTS(-17.03108756633213, 1, turning at positions 2:3, 0.991857463893802, 3, DynamicHMC.Directions(0xefd6f703)), DynamicHMC.TreeStatisticsNUTS(-17.32416997583839, 2, turning at positions -3:0, 0.6675653205051152, 3, DynamicHMC.Directions(0x1a64395c)), DynamicHMC.TreeStatisticsNUTS(-16.065573672272464, 2, turning at positions -3:0, 0.9052686732770878, 3, DynamicHMC.Directions(0x80a8c31c)), DynamicHMC.TreeStatisticsNUTS(-15.637141488122683, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x7b141a76)), DynamicHMC.TreeStatisticsNUTS(-15.613999202953867, 2, turning at positions -3:0, 0.9738248528828479, 3, DynamicHMC.Directions(0x58346e04)), DynamicHMC.TreeStatisticsNUTS(-15.404886677485539, 1, turning at positions 0:1, 0.9785602241450225, 1, DynamicHMC.Directions(0xb1c3a0a3)), DynamicHMC.TreeStatisticsNUTS(-15.861023830822049, 1, turning at positions -1:0, 0.8734256353061435, 1, DynamicHMC.Directions(0xc2e14c0e)), DynamicHMC.TreeStatisticsNUTS(-15.709826070806974, 1, turning at positions -2:-3, 0.9999999999999999, 3, DynamicHMC.Directions(0xd7f11a80))], Œ∫ = Gaussian kinetic energy (Diagonal), ‚àödiag(M‚Åª¬π): [0.4110905424251353], œµ = 1.1347345021211768)
 (posterior_matrix = [0.202572192250612 0.7396843151957053 ‚Ä¶ -0.41684603687372485 -0.17996127602016337], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-15.540495579507535, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x4e64246d)), DynamicHMC.TreeStatisticsNUTS(-17.455619922134016, 2, turning at positions -3:0, 0.7663887263105872, 3, DynamicHMC.Directions(0x4c82d278)), DynamicHMC.TreeStatisticsNUTS(-17.50334735985754, 1, turning at positions 0:1, 0.8844644113867519, 1, DynamicHMC.Directions(0x8358c683)), DynamicHMC.TreeStatisticsNUTS(-18.21849037504723, 2, turning at positions -2:1, 0.912961076585983, 3, DynamicHMC.Directions(0x22a51589)), DynamicHMC.TreeStatisticsNUTS(-18.966889357334423, 2, turning at positions 0:3, 0.6178202086682935, 3, DynamicHMC.Directions(0xd415092f)), DynamicHMC.TreeStatisticsNUTS(-16.306425874068335, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x711820ff)), DynamicHMC.TreeStatisticsNUTS(-15.928110549342742, 1, turning at positions -2:-3, 0.9997826799339555, 3, DynamicHMC.Directions(0x5fdbb098)), DynamicHMC.TreeStatisticsNUTS(-15.627870487633277, 1, turning at positions 1:2, 0.9533437946168486, 3, DynamicHMC.Directions(0xf6b7f86a)), DynamicHMC.TreeStatisticsNUTS(-15.439080952821353, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0xeecba3b5)), DynamicHMC.TreeStatisticsNUTS(-15.475849442553042, 1, turning at positions -2:-3, 0.9884129430811144, 3, DynamicHMC.Directions(0xdcb8fc08))  ‚Ä¶  DynamicHMC.TreeStatisticsNUTS(-18.71826717017876, 1, turning at positions 0:1, 0.6673867574268078, 1, DynamicHMC.Directions(0xe1862a21)), DynamicHMC.TreeStatisticsNUTS(-18.715393002919985, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x280ea6dc)), DynamicHMC.TreeStatisticsNUTS(-17.55559084829078, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x8975fe0e)), DynamicHMC.TreeStatisticsNUTS(-16.64580006756784, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x1640386a)), DynamicHMC.TreeStatisticsNUTS(-15.272821725161197, 2, turning at positions 0:3, 0.9972905020872654, 3, DynamicHMC.Directions(0xfb51acb7)), DynamicHMC.TreeStatisticsNUTS(-17.659317736364986, 2, turning at positions -3:0, 0.7362330835682999, 3, DynamicHMC.Directions(0x56497540)), DynamicHMC.TreeStatisticsNUTS(-16.83982720495308, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x51638446)), DynamicHMC.TreeStatisticsNUTS(-15.681416544800197, 1, turning at positions 1:2, 0.9323792373954255, 3, DynamicHMC.Directions(0x39d2f1e6)), DynamicHMC.TreeStatisticsNUTS(-15.745040220083023, 1, turning at positions 0:1, 0.9440237649972181, 1, DynamicHMC.Directions(0x3551fcb3)), DynamicHMC.TreeStatisticsNUTS(-16.018743669190343, 2, turning at positions -1:2, 0.9644057944297523, 3, DynamicHMC.Directions(0x910001c6))], Œ∫ = Gaussian kinetic energy (Diagonal), ‚àödiag(M‚Åª¬π): [0.44115649197404616], œµ = 0.975191682113194)
 (posterior_matrix = [0.45828507591280015 -0.09697077088963829 ‚Ä¶ 0.16537120134282432 -0.03846083058910893], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-16.14437455307849, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x0b7f0d21)), DynamicHMC.TreeStatisticsNUTS(-15.745647896876175, 1, turning at positions 2:3, 0.9840134232923816, 3, DynamicHMC.Directions(0x9464031b)), DynamicHMC.TreeStatisticsNUTS(-15.56169703653111, 2, turning at positions 0:3, 0.9504726367377687, 3, DynamicHMC.Directions(0x83792337)), DynamicHMC.TreeStatisticsNUTS(-15.425965679568446, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x36d51af1)), DynamicHMC.TreeStatisticsNUTS(-16.409245367407177, 2, turning at positions -3:0, 0.8165376807718014, 3, DynamicHMC.Directions(0xbf154024)), DynamicHMC.TreeStatisticsNUTS(-17.079815329390446, 1, turning at positions 0:1, 0.7599384648235916, 1, DynamicHMC.Directions(0x5a522071)), DynamicHMC.TreeStatisticsNUTS(-16.693486778197816, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x776baf49)), DynamicHMC.TreeStatisticsNUTS(-16.208439468647924, 1, turning at positions 0:1, 0.949927549499995, 1, DynamicHMC.Directions(0xf8dc0a87)), DynamicHMC.TreeStatisticsNUTS(-15.952804751113531, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x87175c1e)), DynamicHMC.TreeStatisticsNUTS(-15.753705471265945, 1, turning at positions 0:1, 0.9116869609865592, 1, DynamicHMC.Directions(0x927afa3b))  ‚Ä¶  DynamicHMC.TreeStatisticsNUTS(-15.840887512297064, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0xf9b02cc4)), DynamicHMC.TreeStatisticsNUTS(-17.261752894223907, 2, turning at positions 0:3, 0.6861268719576952, 3, DynamicHMC.Directions(0xefdbddcb)), DynamicHMC.TreeStatisticsNUTS(-15.33127471415834, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x15b00e6d)), DynamicHMC.TreeStatisticsNUTS(-15.266697323939619, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xea365fe2)), DynamicHMC.TreeStatisticsNUTS(-15.722414067328895, 1, turning at positions -1:-2, 0.830871713192063, 3, DynamicHMC.Directions(0xa2468c91)), DynamicHMC.TreeStatisticsNUTS(-15.372881246507934, 1, turning at positions 1:2, 0.9728835795345292, 3, DynamicHMC.Directions(0x0fa6307e)), DynamicHMC.TreeStatisticsNUTS(-15.451732643629962, 2, turning at positions -1:2, 0.978150479268312, 3, DynamicHMC.Directions(0xed1fda2a)), DynamicHMC.TreeStatisticsNUTS(-15.262882734913548, 2, turning at positions -3:0, 0.9970387892507748, 3, DynamicHMC.Directions(0x4ed12038)), DynamicHMC.TreeStatisticsNUTS(-15.357771976124702, 2, turning at positions 0:3, 0.9776841323806048, 3, DynamicHMC.Directions(0xcd0adf3f)), DynamicHMC.TreeStatisticsNUTS(-15.31530444186445, 1, turning at positions -2:-3, 0.9974041005298618, 3, DynamicHMC.Directions(0xa9d52508))], Œ∫ = Gaussian kinetic energy (Diagonal), ‚àödiag(M‚Åª¬π): [0.4385999857218929], œµ = 1.1465939664439264)
 (posterior_matrix = [-0.32212640050508906 -0.32212640050508906 ‚Ä¶ -0.12820209974111935 -0.1796565871191968], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-16.071858824067437, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x29248758)), DynamicHMC.TreeStatisticsNUTS(-15.901834152083989, 1, turning at positions 0:1, 0.8879583547288022, 1, DynamicHMC.Directions(0xbc2d81d5)), DynamicHMC.TreeStatisticsNUTS(-16.660269101195023, 1, turning at positions -1:-2, 0.8498144568911505, 3, DynamicHMC.Directions(0x5b9d864d)), DynamicHMC.TreeStatisticsNUTS(-16.264385607870572, 1, turning at positions 2:3, 0.9514931102164995, 3, DynamicHMC.Directions(0x99c61573)), DynamicHMC.TreeStatisticsNUTS(-15.53722337139226, 2, turning at positions -1:2, 0.9881248057873463, 3, DynamicHMC.Directions(0x1e823032)), DynamicHMC.TreeStatisticsNUTS(-15.78461500675497, 1, turning at positions -2:-3, 0.9686024306434432, 3, DynamicHMC.Directions(0x68686890)), DynamicHMC.TreeStatisticsNUTS(-15.83528769803708, 1, turning at positions -1:-2, 0.9120217440898385, 3, DynamicHMC.Directions(0x7dc1e0b9)), DynamicHMC.TreeStatisticsNUTS(-15.71681322303509, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x5dc52286)), DynamicHMC.TreeStatisticsNUTS(-15.385813364197684, 1, turning at positions -1:0, 0.9894803131704021, 1, DynamicHMC.Directions(0x7ec38c94)), DynamicHMC.TreeStatisticsNUTS(-15.45924095031834, 1, turning at positions -1:0, 0.982797904199592, 1, DynamicHMC.Directions(0x6d00c500))  ‚Ä¶  DynamicHMC.TreeStatisticsNUTS(-16.114099553445236, 2, turning at positions 0:3, 0.9024394338745743, 3, DynamicHMC.Directions(0x20aa1c57)), DynamicHMC.TreeStatisticsNUTS(-16.89686285254391, 1, turning at positions 0:1, 0.8304665644358026, 1, DynamicHMC.Directions(0x5e1146ab)), DynamicHMC.TreeStatisticsNUTS(-17.149351902906595, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x740ecdf2)), DynamicHMC.TreeStatisticsNUTS(-17.25701019756696, 1, turning at positions -2:-3, 0.9369433806996955, 3, DynamicHMC.Directions(0x7e3b559c)), DynamicHMC.TreeStatisticsNUTS(-15.422932392791925, 2, turning at positions -1:2, 0.9971555112902662, 3, DynamicHMC.Directions(0xc818409e)), DynamicHMC.TreeStatisticsNUTS(-16.415760758076594, 1, turning at positions 1:2, 0.8167307273089687, 3, DynamicHMC.Directions(0xfa15729a)), DynamicHMC.TreeStatisticsNUTS(-17.28566315759657, 1, turning at positions 1:2, 0.685363318398663, 3, DynamicHMC.Directions(0x64343bb6)), DynamicHMC.TreeStatisticsNUTS(-16.834562021084494, 1, turning at positions -2:-3, 0.9977186966056371, 3, DynamicHMC.Directions(0x869ed450)), DynamicHMC.TreeStatisticsNUTS(-15.381206959445457, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x8b309d0a)), DynamicHMC.TreeStatisticsNUTS(-15.342431930558053, 1, turning at positions 0:1, 0.9888576349182895, 1, DynamicHMC.Directions(0xd6959593))], Œ∫ = Gaussian kinetic energy (Diagonal), ‚àödiag(M‚Åª¬π): [0.46867593607787156], œµ = 0.9263917802430156)
 (posterior_matrix = [-0.6108162782564408 -0.48268589486725977 ‚Ä¶ -0.24360769611208283 0.3566714465340624], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-16.34612846340237, 2, turning at positions -1:2, 0.9683517242059865, 3, DynamicHMC.Directions(0xdbf0f1e6)), DynamicHMC.TreeStatisticsNUTS(-16.25912064980015, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0x585d8eca)), DynamicHMC.TreeStatisticsNUTS(-15.819014292636863, 1, turning at positions 2:3, 0.9999999999999999, 3, DynamicHMC.Directions(0xe7c866d3)), DynamicHMC.TreeStatisticsNUTS(-15.518824625421905, 1, turning at positions 1:2, 0.9446857339821962, 3, DynamicHMC.Directions(0xefa545ce)), DynamicHMC.TreeStatisticsNUTS(-16.238219698736927, 1, turning at positions -1:-2, 0.8943810966582953, 3, DynamicHMC.Directions(0xc26573a9)), DynamicHMC.TreeStatisticsNUTS(-15.601730978583204, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0xac43bb66)), DynamicHMC.TreeStatisticsNUTS(-15.426509870253794, 1, turning at positions 2:3, 0.9898167626841757, 3, DynamicHMC.Directions(0xd5677c27)), DynamicHMC.TreeStatisticsNUTS(-17.096316779070982, 2, turning at positions 0:3, 0.7311427774781993, 3, DynamicHMC.Directions(0x99664953)), DynamicHMC.TreeStatisticsNUTS(-15.537703008689494, 1, turning at positions -1:-2, 0.941333283805914, 3, DynamicHMC.Directions(0x7c0d4979)), DynamicHMC.TreeStatisticsNUTS(-15.484753849608415, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x690dee49))  ‚Ä¶  DynamicHMC.TreeStatisticsNUTS(-16.021976448540713, 1, turning at positions -1:0, 0.8597489911645598, 1, DynamicHMC.Directions(0xa6f3e026)), DynamicHMC.TreeStatisticsNUTS(-15.921126906843945, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xdeead216)), DynamicHMC.TreeStatisticsNUTS(-15.42823439857331, 2, turning at positions 0:3, 0.9793030218963983, 3, DynamicHMC.Directions(0xc406346f)), DynamicHMC.TreeStatisticsNUTS(-15.325075827944804, 1, turning at positions 2:3, 0.9970221883909498, 3, DynamicHMC.Directions(0xf29bb3eb)), DynamicHMC.TreeStatisticsNUTS(-15.319809407977301, 2, turning at positions 0:3, 0.99139003062542, 3, DynamicHMC.Directions(0x8785441b)), DynamicHMC.TreeStatisticsNUTS(-15.729645353447541, 1, turning at positions 1:2, 0.9188631763915732, 3, DynamicHMC.Directions(0xe4f38c42)), DynamicHMC.TreeStatisticsNUTS(-16.22133629487156, 1, turning at positions -2:-3, 0.9423032514074065, 3, DynamicHMC.Directions(0xf6f46e64)), DynamicHMC.TreeStatisticsNUTS(-15.415556095021463, 1, turning at positions -2:-3, 0.9999999999999999, 3, DynamicHMC.Directions(0x20cbee64)), DynamicHMC.TreeStatisticsNUTS(-15.412113477159533, 1, turning at positions -1:0, 0.967137881310507, 1, DynamicHMC.Directions(0x0a8dde8a)), DynamicHMC.TreeStatisticsNUTS(-16.02362407571469, 1, turning at positions 1:2, 0.9144342165111495, 3, DynamicHMC.Directions(0x702bb102))], Œ∫ = Gaussian kinetic energy (Diagonal), ‚àödiag(M‚Åª¬π): [0.4045429096932505], œµ = 1.096051476068476)</code></pre><p>To get the posterior for <span>$Œ±$</span>, we need to use the columns of the <code>posterior_matrix</code> and then transform</p><pre><code class="language-julia hljs">posterior = transform.(t, eachcol(pool_posterior_matrices(results)));</code></pre><p>Extract the parameter.</p><pre><code class="language-julia hljs">posterior_Œ± = first.(posterior);</code></pre><p>check the mean</p><pre><code class="language-julia hljs">mean(posterior_Œ±)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.50056450159148</code></pre><p>check the effective sample size</p><pre><code class="language-julia hljs">ess, RÃÇ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([1812.6646159771149], [1.0019893256078067])</code></pre><p>NUTS-specific statistics of the first chain</p><pre><code class="language-julia hljs">summarize_tree_statistics(results[1].tree_statistics)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Hamiltonian Monte Carlo sample of length 1000
  acceptance rate mean: 0.91, 5/25/50/75/95%: 0.64 0.87 0.97 1.0 1.0
  termination: divergence =&gt; 0%, max_depth =&gt; 0%, turning =&gt; 100%
  depth: 0 =&gt; 0%, 1 =&gt; 59%, 2 =&gt; 41%</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">¬´ Overview</a><a class="docs-footer-nextpage" href="../example_linear_regression/">Linear regression ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 3 September 2022 07:30">Saturday 3 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
