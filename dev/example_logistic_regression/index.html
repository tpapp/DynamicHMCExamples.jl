<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic regression · DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../example_independent_bernoulli/">Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li class="is-active"><a class="tocitem" href>Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Logistic regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_logistic_regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Logistic-regression"><a class="docs-heading-anchor" href="#Logistic-regression">Logistic regression</a><a id="Logistic-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-regression" title="Permalink"></a></h1><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, LogDensityProblemsAD,
    DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra, StatsFuns, LogExpFunctions</code></pre><p>then diagnostic and benchmark tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, BenchmarkTools</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff

&quot;&quot;&quot;
Logistic regression.

For each draw, ``logit(Pr(yᵢ == 1)) ∼ Xᵢ β``. Uses a `β ∼ Normal(0, σ)` prior.

`X` is supposed to include the `1`s for the intercept.
&quot;&quot;&quot;
struct LogisticRegression{Ty, TX, Tσ}
    y::Ty
    X::TX
    σ::Tσ
end

function (problem::LogisticRegression)(θ)
    @unpack y, X, σ = problem
    @unpack β = θ
    ℓ_y = mapreduce((y, x) -&gt; logpdf(Bernoulli(logistic(dot(x, β))), y), +, y, eachrow(X))
    ℓ_β =  loglikelihood(Normal(0, σ), β)
    ℓ_y + ℓ_β
end</code></pre><p>Make up parameters, generate data using random draws.</p><pre><code class="language-julia hljs">N = 1000
β = [1.0, 2.0]
X = hcat(ones(N), randn(N))
y = rand.(Bernoulli.(logistic.(X*β)));</code></pre><p>Create a problem, apply a transformation, then use automatic differentiation.</p><pre><code class="language-julia hljs">p = LogisticRegression(y, X, 10.0)   # data and (vague) priors
t = as((β = as(Array, length(β)), )) # identity transformation, just to get the dimension
P = TransformedLogDensity(t, p)      # transformed
∇P = ADgradient(:ForwardDiff, P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ForwardDiff AD wrapper for TransformedLogDensity of dimension 2, w/ chunk size 2</code></pre><p>Benchmark</p><pre><code class="language-julia hljs">@btime p((β = $β,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-429.73594216880645</code></pre><p>Sample using NUTS, random starting point.</p><pre><code class="language-julia hljs">results = map(_ -&gt; mcmc_with_warmup(Random.default_rng(), ∇P, 1000), 1:5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :κ, :ϵ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [1.021565223386375 1.021565223386375 … 0.9873506640481137 1.0415967623242213; 2.129228268401059 2.129228268401059 … 1.9634773803135248 1.9637657249240061], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-431.75593625851667, 2, turning at positions 4:7, 0.9999999999999999, 7, DynamicHMC.Directions(0x44640df7)), DynamicHMC.TreeStatisticsNUTS(-430.07593706468896, 1, turning at positions -1:0, 0.9053571422556417, 1, DynamicHMC.Directions(0xda8022b4)), DynamicHMC.TreeStatisticsNUTS(-431.483631731019, 2, turning at positions 0:3, 0.770786598263863, 3, DynamicHMC.Directions(0xb14684bf)), DynamicHMC.TreeStatisticsNUTS(-430.34658928411454, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0xe8dd501e)), DynamicHMC.TreeStatisticsNUTS(-431.2356692990667, 3, turning at positions -1:6, 0.9733157479579092, 7, DynamicHMC.Directions(0x6eb6ff66)), DynamicHMC.TreeStatisticsNUTS(-430.98701005884203, 2, turning at positions -1:2, 0.9690569756634294, 3, DynamicHMC.Directions(0x988bf1be)), DynamicHMC.TreeStatisticsNUTS(-429.8269141337002, 2, turning at positions -3:0, 0.9816499617707949, 3, DynamicHMC.Directions(0x83f60d04)), DynamicHMC.TreeStatisticsNUTS(-430.2138806886819, 2, turning at positions -2:1, 0.8751281042691051, 3, DynamicHMC.Directions(0xb545a505)), DynamicHMC.TreeStatisticsNUTS(-430.7877635364784, 2, turning at positions 2:5, 0.9102901647340086, 7, DynamicHMC.Directions(0xa17072ed)), DynamicHMC.TreeStatisticsNUTS(-430.4699222434697, 2, turning at positions 1:2, 0.9471827788319539, 5, DynamicHMC.Directions(0xacdc20a4))  …  DynamicHMC.TreeStatisticsNUTS(-432.16679880562714, 3, turning at positions -7:0, 0.9032380471291355, 7, DynamicHMC.Directions(0x355ccda8)), DynamicHMC.TreeStatisticsNUTS(-434.5040336830547, 2, turning at positions -1:-4, 0.6229506300824494, 7, DynamicHMC.Directions(0x61cb75a3)), DynamicHMC.TreeStatisticsNUTS(-434.01183237201235, 2, turning at positions -2:1, 0.7791437207460458, 3, DynamicHMC.Directions(0xe6b2df15)), DynamicHMC.TreeStatisticsNUTS(-430.5193614664728, 1, turning at positions 1:2, 0.9100193595941617, 3, DynamicHMC.Directions(0x408f0a02)), DynamicHMC.TreeStatisticsNUTS(-429.7698051062772, 2, turning at positions -3:0, 0.9882882736858362, 3, DynamicHMC.Directions(0x7d2f6f54)), DynamicHMC.TreeStatisticsNUTS(-431.0291994312748, 2, turning at positions -3:0, 0.812811020677763, 3, DynamicHMC.Directions(0x5edf735c)), DynamicHMC.TreeStatisticsNUTS(-430.28467523216347, 3, turning at positions -7:0, 0.9962877598255592, 7, DynamicHMC.Directions(0x0822e510)), DynamicHMC.TreeStatisticsNUTS(-430.796152020296, 2, turning at positions 0:3, 0.8959739166754574, 3, DynamicHMC.Directions(0x350479d3)), DynamicHMC.TreeStatisticsNUTS(-430.0321183204012, 1, turning at positions -1:0, 0.99167268546127, 1, DynamicHMC.Directions(0x0047304e)), DynamicHMC.TreeStatisticsNUTS(-430.10900438031877, 2, turning at positions -1:2, 0.9932933172872969, 3, DynamicHMC.Directions(0xdd5e8c56))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.0958196555046985, 0.159389969528401], ϵ = 0.7490650053570637)
 (posterior_matrix = [1.2016561109082835 1.1154048127968534 … 1.175856933974631 1.1310988956029013; 2.05602325169066 2.0565669933305513 … 2.0793644179273474 2.1807071470064683], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-431.30321914087375, 2, turning at positions 0:3, 0.8736870289699152, 3, DynamicHMC.Directions(0xdcc454ab)), DynamicHMC.TreeStatisticsNUTS(-430.40418607501624, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x74f6e466)), DynamicHMC.TreeStatisticsNUTS(-429.49220371373974, 1, turning at positions 2:3, 0.9955563718778829, 3, DynamicHMC.Directions(0x1005ffef)), DynamicHMC.TreeStatisticsNUTS(-429.82288585817093, 2, turning at positions -1:-2, 0.9224625169196043, 5, DynamicHMC.Directions(0xafe037f3)), DynamicHMC.TreeStatisticsNUTS(-429.55521818383767, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x464ebdca)), DynamicHMC.TreeStatisticsNUTS(-429.7674282177383, 2, turning at positions 0:3, 0.9702652625117275, 3, DynamicHMC.Directions(0x206bb2af)), DynamicHMC.TreeStatisticsNUTS(-430.6764844077984, 2, turning at positions -3:0, 0.8806927123210034, 3, DynamicHMC.Directions(0x62374f28)), DynamicHMC.TreeStatisticsNUTS(-431.13722146283317, 1, turning at positions -1:0, 0.9419252278986291, 1, DynamicHMC.Directions(0xd5ccaaba)), DynamicHMC.TreeStatisticsNUTS(-434.1776209452443, 2, turning at positions 0:3, 0.7878523136481032, 3, DynamicHMC.Directions(0xdff218c7)), DynamicHMC.TreeStatisticsNUTS(-431.22896753081983, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xa13742ae))  …  DynamicHMC.TreeStatisticsNUTS(-430.1215136288844, 2, turning at positions -3:0, 0.9678787830868343, 3, DynamicHMC.Directions(0x5fead328)), DynamicHMC.TreeStatisticsNUTS(-429.6310113617199, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xcccced5a)), DynamicHMC.TreeStatisticsNUTS(-429.52627732686807, 1, turning at positions -1:0, 0.9681147542545786, 1, DynamicHMC.Directions(0xec802cd6)), DynamicHMC.TreeStatisticsNUTS(-430.02242318915114, 1, turning at positions 0:1, 0.8845667770754649, 1, DynamicHMC.Directions(0xce6e5cd3)), DynamicHMC.TreeStatisticsNUTS(-434.56460963876475, 2, turning at positions 0:3, 0.6520250549122525, 3, DynamicHMC.Directions(0xa234b8b3)), DynamicHMC.TreeStatisticsNUTS(-433.1099376909112, 2, turning at positions 0:3, 0.7456201745077641, 3, DynamicHMC.Directions(0x1daf9e6b)), DynamicHMC.TreeStatisticsNUTS(-431.74912937921704, 2, turning at positions 3:6, 0.9709650786136226, 7, DynamicHMC.Directions(0xbaa68646)), DynamicHMC.TreeStatisticsNUTS(-430.8898938742794, 2, turning at positions 1:4, 0.8483618324615805, 7, DynamicHMC.Directions(0x54dbb0bc)), DynamicHMC.TreeStatisticsNUTS(-431.55000706548384, 1, turning at positions -1:-2, 0.8914980543569953, 3, DynamicHMC.Directions(0xda8de209)), DynamicHMC.TreeStatisticsNUTS(-429.8124459527838, 3, turning at positions -4:3, 0.9999122873724791, 7, DynamicHMC.Directions(0xa2c4f803))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09229299525482713, 0.14080575863442354], ϵ = 0.7481802801803895)
 (posterior_matrix = [1.1471864999864212 0.9000833805502341 … 1.2332538217022462 1.2945537856275862; 1.7935672421670352 2.084590685466688 … 2.177229852270431 2.245309558940498], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-433.64123013984755, 2, turning at positions -1:2, 0.6940443253962757, 3, DynamicHMC.Directions(0xe584c802)), DynamicHMC.TreeStatisticsNUTS(-433.5855414907977, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x0061bc8e)), DynamicHMC.TreeStatisticsNUTS(-431.56134895678684, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x76311287)), DynamicHMC.TreeStatisticsNUTS(-430.6746626097628, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0xf35410f9)), DynamicHMC.TreeStatisticsNUTS(-430.7586375281989, 2, turning at positions -2:1, 0.9263325867958221, 3, DynamicHMC.Directions(0x1e5982e5)), DynamicHMC.TreeStatisticsNUTS(-431.8581608637481, 2, turning at positions -2:1, 0.8887880746604465, 3, DynamicHMC.Directions(0xa242e60d)), DynamicHMC.TreeStatisticsNUTS(-431.4784668174123, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x9bd8bf16)), DynamicHMC.TreeStatisticsNUTS(-430.7061112104705, 3, turning at positions -6:1, 0.9872308833071426, 7, DynamicHMC.Directions(0x586f9929)), DynamicHMC.TreeStatisticsNUTS(-430.7516480913325, 2, turning at positions -2:1, 0.9953277102148594, 3, DynamicHMC.Directions(0xd6bbd2b5)), DynamicHMC.TreeStatisticsNUTS(-430.34139415348415, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xb456369e))  …  DynamicHMC.TreeStatisticsNUTS(-432.23339193169704, 2, turning at positions -2:1, 0.9810873724180785, 3, DynamicHMC.Directions(0x47fc39e1)), DynamicHMC.TreeStatisticsNUTS(-432.50627178861413, 2, turning at positions -2:1, 0.9962268013044026, 3, DynamicHMC.Directions(0x07870361)), DynamicHMC.TreeStatisticsNUTS(-432.66831648046673, 2, turning at positions -1:2, 0.899932216818264, 3, DynamicHMC.Directions(0x1700cc62)), DynamicHMC.TreeStatisticsNUTS(-431.9000535996901, 3, turning at positions -4:3, 0.9632166515195627, 7, DynamicHMC.Directions(0x748fa643)), DynamicHMC.TreeStatisticsNUTS(-432.3739230293907, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x9c6ff7c2)), DynamicHMC.TreeStatisticsNUTS(-431.97606868921747, 1, turning at positions 0:1, 0.8925460760078491, 1, DynamicHMC.Directions(0xcb724c25)), DynamicHMC.TreeStatisticsNUTS(-431.9466098948599, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0xaba5c3d1)), DynamicHMC.TreeStatisticsNUTS(-430.26407289527407, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xf68dac42)), DynamicHMC.TreeStatisticsNUTS(-430.765591762138, 2, turning at positions 0:3, 0.9714783999123617, 3, DynamicHMC.Directions(0xa76d04bb)), DynamicHMC.TreeStatisticsNUTS(-432.24289829989596, 2, turning at positions -1:2, 0.8687059981977909, 3, DynamicHMC.Directions(0xa0818a1a))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09947097947765202, 0.13872288220869733], ϵ = 0.6958156915233674)
 (posterior_matrix = [1.2560581841878558 1.1596889420663266 … 1.083656664345478 1.126187361484315; 2.299512902641898 2.248265957199421 … 2.034001515972305 2.0839372000342813], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-432.30284582806905, 2, turning at positions 0:3, 0.691045319552388, 3, DynamicHMC.Directions(0x9fbcf237)), DynamicHMC.TreeStatisticsNUTS(-430.85102591379456, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x91e8e549)), DynamicHMC.TreeStatisticsNUTS(-431.02111289812393, 2, turning at positions 3:4, 0.9421730862224458, 5, DynamicHMC.Directions(0x55fb731e)), DynamicHMC.TreeStatisticsNUTS(-430.1661522931281, 3, turning at positions -1:6, 0.9749787989630295, 7, DynamicHMC.Directions(0x6f4dfaf6)), DynamicHMC.TreeStatisticsNUTS(-430.4981140380854, 3, turning at positions -1:6, 0.9411549560073663, 7, DynamicHMC.Directions(0xf94bff96)), DynamicHMC.TreeStatisticsNUTS(-430.9754150793202, 1, turning at positions -1:0, 0.9296034865402796, 1, DynamicHMC.Directions(0x4d5136e0)), DynamicHMC.TreeStatisticsNUTS(-432.3011408566424, 2, turning at positions -3:0, 0.8493437743243176, 3, DynamicHMC.Directions(0xd6438e20)), DynamicHMC.TreeStatisticsNUTS(-431.5030846267854, 2, turning at positions 2:3, 0.8597638967270085, 5, DynamicHMC.Directions(0xcb90e535)), DynamicHMC.TreeStatisticsNUTS(-436.00833820350863, 3, turning at positions -6:1, 0.777811720969509, 7, DynamicHMC.Directions(0xb5b08221)), DynamicHMC.TreeStatisticsNUTS(-433.15790868345147, 2, turning at positions 0:3, 0.9966301045118656, 3, DynamicHMC.Directions(0x6476557f))  …  DynamicHMC.TreeStatisticsNUTS(-434.0308930549352, 1, turning at positions -1:0, 0.726408182730363, 1, DynamicHMC.Directions(0x2fc7075c)), DynamicHMC.TreeStatisticsNUTS(-433.59998481383315, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0xfc05f6c7)), DynamicHMC.TreeStatisticsNUTS(-432.1159925898723, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x66143639)), DynamicHMC.TreeStatisticsNUTS(-432.2666281346427, 3, turning at positions -7:0, 0.8520379278569825, 7, DynamicHMC.Directions(0x6b828518)), DynamicHMC.TreeStatisticsNUTS(-430.6071198149174, 2, turning at positions -1:2, 0.9912933710849489, 3, DynamicHMC.Directions(0x0de94592)), DynamicHMC.TreeStatisticsNUTS(-435.2248148991126, 2, turning at positions -1:2, 0.48383859454436795, 3, DynamicHMC.Directions(0x802acd5a)), DynamicHMC.TreeStatisticsNUTS(-434.8029897294958, 3, turning at positions -3:4, 0.9999999999999999, 7, DynamicHMC.Directions(0x2fb7db5c)), DynamicHMC.TreeStatisticsNUTS(-431.9842582459106, 1, turning at positions -2:-3, 0.9999999999999999, 3, DynamicHMC.Directions(0x97ff6d94)), DynamicHMC.TreeStatisticsNUTS(-431.0284796965119, 3, turning at positions -2:5, 0.9076920165198719, 7, DynamicHMC.Directions(0xa5d77ed5)), DynamicHMC.TreeStatisticsNUTS(-429.6346881550912, 2, turning at positions -2:1, 0.9589487770802075, 3, DynamicHMC.Directions(0x32a791b9))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09283643869592835, 0.14183849173177002], ϵ = 0.7670179782132718)
 (posterior_matrix = [1.147720932664761 1.0491089944279117 … 1.100161811586659 1.0777614829445767; 1.9659870530455055 1.9226538132240314 … 1.9337559027545903 2.2116094728160562], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-431.2765293970247, 1, turning at positions 1:2, 0.8155605762755028, 3, DynamicHMC.Directions(0xdb108e46)), DynamicHMC.TreeStatisticsNUTS(-431.4147325449179, 2, turning at positions -3:0, 0.9762932865774232, 3, DynamicHMC.Directions(0x6b50f288)), DynamicHMC.TreeStatisticsNUTS(-430.0030661272561, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x135d4652)), DynamicHMC.TreeStatisticsNUTS(-430.4479197573284, 2, turning at positions 3:6, 0.9396323945177072, 7, DynamicHMC.Directions(0x7ef38ede)), DynamicHMC.TreeStatisticsNUTS(-430.14307994346603, 2, turning at positions -1:2, 0.9808081343051743, 3, DynamicHMC.Directions(0x315684e6)), DynamicHMC.TreeStatisticsNUTS(-430.32709955040036, 2, turning at positions 3:6, 0.9728442488826314, 7, DynamicHMC.Directions(0x43d45e4e)), DynamicHMC.TreeStatisticsNUTS(-429.7545145810435, 1, turning at positions -1:0, 0.9677548649190775, 1, DynamicHMC.Directions(0xcd692ea2)), DynamicHMC.TreeStatisticsNUTS(-430.57274025444985, 3, turning at positions 0:7, 0.9875085198565119, 7, DynamicHMC.Directions(0xce4344af)), DynamicHMC.TreeStatisticsNUTS(-431.1946604024352, 2, turning at positions -2:-5, 0.9643480129843586, 7, DynamicHMC.Directions(0xfe19da9a)), DynamicHMC.TreeStatisticsNUTS(-432.3057529362245, 2, turning at positions 4:7, 0.9163437316503068, 7, DynamicHMC.Directions(0x7a2391af))  …  DynamicHMC.TreeStatisticsNUTS(-435.5338172058827, 2, turning at positions 3:6, 0.8648143294079877, 7, DynamicHMC.Directions(0xaf6389c6)), DynamicHMC.TreeStatisticsNUTS(-431.8039004662136, 2, turning at positions -2:-5, 0.9970165407922164, 7, DynamicHMC.Directions(0xff269c12)), DynamicHMC.TreeStatisticsNUTS(-431.6049289313588, 2, turning at positions -3:0, 0.8772468400058213, 3, DynamicHMC.Directions(0xdaa2c304)), DynamicHMC.TreeStatisticsNUTS(-432.33742961428703, 2, turning at positions -3:0, 0.9109271584316728, 3, DynamicHMC.Directions(0xb7201df4)), DynamicHMC.TreeStatisticsNUTS(-431.85872633229644, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0xea0ad6d9)), DynamicHMC.TreeStatisticsNUTS(-430.91812974564345, 2, turning at positions 4:7, 0.9565972356487276, 7, DynamicHMC.Directions(0x8ecdf44f)), DynamicHMC.TreeStatisticsNUTS(-431.6832247063685, 3, turning at positions -7:0, 0.9442136611772567, 7, DynamicHMC.Directions(0x846069f8)), DynamicHMC.TreeStatisticsNUTS(-430.77214557655964, 2, turning at positions 0:3, 0.9642705394840734, 3, DynamicHMC.Directions(0x776c95c3)), DynamicHMC.TreeStatisticsNUTS(-430.68624189622534, 3, turning at positions -5:2, 0.9582755000164572, 7, DynamicHMC.Directions(0x21a12a9a)), DynamicHMC.TreeStatisticsNUTS(-430.64769104882225, 2, turning at positions 0:3, 0.9671962722370174, 3, DynamicHMC.Directions(0x18b470df))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09660339226688272, 0.14700579708005418], ϵ = 0.6446846103927972)</code></pre><p>Extract the posterior. (Here the transformation was not really necessary).</p><pre><code class="language-julia hljs">β_posterior = first.(transform.(t, eachcol(pool_posterior_matrices(results))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5000-element Vector{Vector{Float64}}:
 [1.021565223386375, 2.129228268401059]
 [1.021565223386375, 2.129228268401059]
 [1.1564574822374216, 1.9842737216610855]
 [1.149629831465162, 2.011527575887006]
 [0.9257665985180717, 2.0192022446189895]
 [1.0219784047090674, 2.0198474492888905]
 [1.0072124745553928, 2.009114425774739]
 [1.1164754722447119, 2.0120299658955694]
 [1.1350662047153481, 2.2340343059603662]
 [1.011633752483778, 1.8916865445953943]
 ⋮
 [1.1528915659805101, 2.2974485805079023]
 [1.0759007969305892, 2.300556355252405]
 [1.2934576859067173, 2.106777283285844]
 [1.2330046907537928, 2.218425646231945]
 [1.0157798764872188, 2.1286377189671573]
 [0.9834174625662511, 2.1017410768044273]
 [0.9694149291000466, 2.014773846427008]
 [1.100161811586659, 1.9337559027545903]
 [1.0777614829445767, 2.2116094728160562]</code></pre><p>Check that we recover the parameters.</p><pre><code class="language-julia hljs">mean(β_posterior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 1.0982600443075414
 2.113757037647715</code></pre><p>Quantiles</p><pre><code class="language-julia hljs">qs = [0.05, 0.25, 0.5, 0.75, 0.95]
quantile(first.(β_posterior), qs)

quantile(last.(β_posterior), qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.888117178260791
 2.0153823168241027
 2.107950470230392
 2.2088908763325215
 2.3498117760834636</code></pre><p>Check that mixing is good.</p><pre><code class="language-julia hljs">ess, R̂ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ess = [2351.5546443633716, 2308.778996140013], rhat = [1.0022339390886734, 1.0004857258885556])</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_linear_regression/">« Linear regression</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 30 October 2023 10:20">Monday 30 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
