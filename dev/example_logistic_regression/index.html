<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic regression · DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../example_independent_bernoulli/">Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li class="is-active"><a class="tocitem" href>Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Logistic regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_logistic_regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Logistic-regression"><a class="docs-heading-anchor" href="#Logistic-regression">Logistic regression</a><a id="Logistic-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-regression" title="Permalink"></a></h1><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra, StatsFuns, LogExpFunctions</code></pre><p>then diagnostic and benchmark tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, BenchmarkTools</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff

&quot;&quot;&quot;
Logistic regression.

For each draw, ``logit(Pr(yᵢ == 1)) ∼ Xᵢ β``. Uses a `β ∼ Normal(0, σ)` prior.

`X` is supposed to include the `1`s for the intercept.
&quot;&quot;&quot;
struct LogisticRegression{Ty, TX, Tσ}
    y::Ty
    X::TX
    σ::Tσ
end

function (problem::LogisticRegression)(θ)
    @unpack y, X, σ = problem
    @unpack β = θ
    ℓ_y = mapreduce((y, x) -&gt; logpdf(Bernoulli(logistic(dot(x, β))), y), +, y, eachrow(X))
    ℓ_β =  loglikelihood(Normal(0, σ), β)
    ℓ_y + ℓ_β
end</code></pre><p>Make up parameters, generate data using random draws.</p><pre><code class="language-julia hljs">N = 1000
β = [1.0, 2.0]
X = hcat(ones(N), randn(N))
y = rand.(Bernoulli.(logistic.(X*β)));</code></pre><p>Create a problem, apply a transformation, then use automatic differentiation.</p><pre><code class="language-julia hljs">p = LogisticRegression(y, X, 10.0)   # data and (vague) priors
t = as((β = as(Array, length(β)), )) # identity transformation, just to get the dimension
P = TransformedLogDensity(t, p)      # transformed
∇P = ADgradient(:ForwardDiff, P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ForwardDiff AD wrapper for TransformedLogDensity of dimension 2, w/ chunk size 2</code></pre><p>Benchmark</p><pre><code class="language-julia hljs">@btime p((β = $β,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-465.413089989141</code></pre><p>Sample using NUTS, random starting point.</p><pre><code class="language-julia hljs">results = map(_ -&gt; mcmc_with_warmup(Random.default_rng(), ∇P, 1000), 1:5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :κ, :ϵ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [0.8957306840736181 0.965596072543925 … 0.9107452799250445 0.9433113808422839; 1.7892514908542854 1.9886337937277225 … 1.9004842059200433 1.853334231929743], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-465.8007730245406, 2, turning at positions -3:0, 0.9489664576563862, 3, DynamicHMC.Directions(0x552199fc)), DynamicHMC.TreeStatisticsNUTS(-466.65055475611547, 1, turning at positions 2:3, 0.7710825194155636, 3, DynamicHMC.Directions(0xa2fdf5cb)), DynamicHMC.TreeStatisticsNUTS(-466.09555166636943, 2, turning at positions -3:0, 0.9170043638868917, 3, DynamicHMC.Directions(0x44d3f1c4)), DynamicHMC.TreeStatisticsNUTS(-466.1939176723714, 2, turning at positions -2:1, 0.9942636349144168, 3, DynamicHMC.Directions(0x48adec4d)), DynamicHMC.TreeStatisticsNUTS(-465.86689931933813, 2, turning at positions -2:1, 0.9817876174549669, 3, DynamicHMC.Directions(0x5d831051)), DynamicHMC.TreeStatisticsNUTS(-465.42312665819514, 3, turning at positions -7:0, 0.9894652777241338, 7, DynamicHMC.Directions(0x819e2b48)), DynamicHMC.TreeStatisticsNUTS(-467.284709369626, 2, turning at positions -3:0, 0.8545357354252373, 3, DynamicHMC.Directions(0xc65450c8)), DynamicHMC.TreeStatisticsNUTS(-464.1869701763881, 2, turning at positions -2:1, 0.988669449429588, 3, DynamicHMC.Directions(0xc7e68a1d)), DynamicHMC.TreeStatisticsNUTS(-465.5564257060685, 2, turning at positions -3:0, 0.8598625825496472, 3, DynamicHMC.Directions(0xd373195c)), DynamicHMC.TreeStatisticsNUTS(-465.66641737378177, 2, turning at positions -4:-7, 0.9865138050877933, 7, DynamicHMC.Directions(0xbecdad80))  …  DynamicHMC.TreeStatisticsNUTS(-468.91635817104793, 2, turning at positions 0:3, 0.5301125960612622, 3, DynamicHMC.Directions(0x493b853b)), DynamicHMC.TreeStatisticsNUTS(-467.2161169796348, 3, turning at positions -6:1, 0.8982879943650669, 7, DynamicHMC.Directions(0x9bf4f921)), DynamicHMC.TreeStatisticsNUTS(-465.06862492900376, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x21c9929d)), DynamicHMC.TreeStatisticsNUTS(-465.4688450742141, 3, turning at positions -2:5, 0.932578157030755, 7, DynamicHMC.Directions(0x61637dfd)), DynamicHMC.TreeStatisticsNUTS(-464.1651607933153, 2, turning at positions -2:-5, 0.9791198091023899, 7, DynamicHMC.Directions(0xd573e46a)), DynamicHMC.TreeStatisticsNUTS(-464.79657269804665, 2, turning at positions -3:0, 0.9389599154198166, 3, DynamicHMC.Directions(0x0bbf9184)), DynamicHMC.TreeStatisticsNUTS(-465.94026608259105, 3, turning at positions -6:1, 0.8700899449717517, 7, DynamicHMC.Directions(0xac3d5671)), DynamicHMC.TreeStatisticsNUTS(-465.05987589161185, 2, turning at positions -1:2, 0.9869502222991432, 3, DynamicHMC.Directions(0x7a2d7ab6)), DynamicHMC.TreeStatisticsNUTS(-464.7761098406828, 2, turning at positions 0:3, 0.9999999999999999, 3, DynamicHMC.Directions(0x6f6e2077)), DynamicHMC.TreeStatisticsNUTS(-465.6361838376132, 3, turning at positions -2:5, 0.8128241016885293, 7, DynamicHMC.Directions(0x4db0f195))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09100713661096528, 0.11715723775914783], ϵ = 0.811914753863347)
 (posterior_matrix = [0.9596540073568922 0.8838241330899461 … 0.7146370525023682 0.7776285195267336; 1.797342748499733 1.933156755805845 … 1.5232756843961806 1.608166137226612], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-464.8938161849013, 2, turning at positions 0:3, 0.9126910647051116, 3, DynamicHMC.Directions(0x9f1dbadb)), DynamicHMC.TreeStatisticsNUTS(-465.15788358915745, 2, turning at positions -2:1, 0.9101684655330656, 3, DynamicHMC.Directions(0xee61c069)), DynamicHMC.TreeStatisticsNUTS(-464.8350456750846, 1, turning at positions 0:1, 0.967205467204045, 1, DynamicHMC.Directions(0xed92a81d)), DynamicHMC.TreeStatisticsNUTS(-466.62457801900075, 3, turning at positions -2:5, 0.9094638210367624, 7, DynamicHMC.Directions(0x02354b55)), DynamicHMC.TreeStatisticsNUTS(-466.8402331299793, 2, turning at positions -4:-7, 0.7558643771292085, 7, DynamicHMC.Directions(0xa8cd1170)), DynamicHMC.TreeStatisticsNUTS(-467.4232303728152, 3, turning at positions -6:1, 0.7422443071111129, 7, DynamicHMC.Directions(0xbc62c5e9)), DynamicHMC.TreeStatisticsNUTS(-468.8246225366713, 3, turning at positions -7:0, 0.7923956218664426, 7, DynamicHMC.Directions(0x4e0c16f8)), DynamicHMC.TreeStatisticsNUTS(-467.77841760502906, 2, turning at positions -3:0, 0.9999999999999999, 3, DynamicHMC.Directions(0x9cc8e098)), DynamicHMC.TreeStatisticsNUTS(-466.2931451082431, 1, turning at positions 2:3, 0.9999999999999999, 3, DynamicHMC.Directions(0x64d130b3)), DynamicHMC.TreeStatisticsNUTS(-465.23891506690165, 3, turning at positions -1:6, 0.893687377804271, 7, DynamicHMC.Directions(0xb0be9a8e))  …  DynamicHMC.TreeStatisticsNUTS(-471.1589567250055, 2, turning at positions -1:2, 0.17567854302008531, 3, DynamicHMC.Directions(0x8458a096)), DynamicHMC.TreeStatisticsNUTS(-465.42543602275396, 2, turning at positions 0:3, 0.9688041684068865, 3, DynamicHMC.Directions(0xf2bb1113)), DynamicHMC.TreeStatisticsNUTS(-464.66149299261275, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x6adf0c9d)), DynamicHMC.TreeStatisticsNUTS(-467.6801313623616, 1, turning at positions 2:3, 0.7210490663747794, 3, DynamicHMC.Directions(0x82d235ab)), DynamicHMC.TreeStatisticsNUTS(-465.87524800606036, 1, turning at positions -1:-2, 0.9083290759648354, 3, DynamicHMC.Directions(0x8305235d)), DynamicHMC.TreeStatisticsNUTS(-466.58969962966097, 2, turning at positions 0:3, 0.6929212118326776, 3, DynamicHMC.Directions(0x38e1ce37)), DynamicHMC.TreeStatisticsNUTS(-464.73643252516354, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x36f1c4bb)), DynamicHMC.TreeStatisticsNUTS(-466.3810873954816, 2, turning at positions -3:0, 0.8915461609112825, 3, DynamicHMC.Directions(0x72f7da2c)), DynamicHMC.TreeStatisticsNUTS(-467.7805988309508, 1, turning at positions -1:0, 0.782836633576281, 1, DynamicHMC.Directions(0x3c753a6a)), DynamicHMC.TreeStatisticsNUTS(-467.286222089678, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x04f92e72))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09244360376138301, 0.12137525626165137], ϵ = 0.8497024859268051)
 (posterior_matrix = [0.9132879877620704 0.9014449186671626 … 0.9238397269241561 0.8803221618057883; 1.6603661802630434 1.5870058065816284 … 1.837373791242298 1.9192537871228106], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-466.3280639828412, 2, turning at positions -3:-6, 0.9459558689239348, 7, DynamicHMC.Directions(0xbe463b09)), DynamicHMC.TreeStatisticsNUTS(-466.09051591375066, 2, turning at positions -2:1, 0.940046443010513, 3, DynamicHMC.Directions(0xa7ca2f5d)), DynamicHMC.TreeStatisticsNUTS(-467.3902071392837, 2, turning at positions -1:2, 0.897125622096425, 3, DynamicHMC.Directions(0x74517b42)), DynamicHMC.TreeStatisticsNUTS(-464.8932236256257, 2, turning at positions -2:1, 0.9566539983498337, 3, DynamicHMC.Directions(0x11393739)), DynamicHMC.TreeStatisticsNUTS(-465.8769662168743, 2, turning at positions -2:1, 0.9149657423770289, 3, DynamicHMC.Directions(0x362cef4d)), DynamicHMC.TreeStatisticsNUTS(-465.8708003201239, 2, turning at positions -3:0, 0.9800968121528909, 3, DynamicHMC.Directions(0x38dc4010)), DynamicHMC.TreeStatisticsNUTS(-464.5275017398385, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x59cb3076)), DynamicHMC.TreeStatisticsNUTS(-464.6018743777641, 2, turning at positions 2:5, 0.9770359347510168, 7, DynamicHMC.Directions(0xb85fd01d)), DynamicHMC.TreeStatisticsNUTS(-464.9425588945678, 2, turning at positions 3:4, 0.9741343294685434, 5, DynamicHMC.Directions(0x8207ca66)), DynamicHMC.TreeStatisticsNUTS(-467.2082537250601, 2, turning at positions -4:-7, 0.806725209353935, 7, DynamicHMC.Directions(0xfb099cf0))  …  DynamicHMC.TreeStatisticsNUTS(-465.3352706635149, 2, turning at positions 4:7, 0.9992692492740594, 7, DynamicHMC.Directions(0x661ad8cf)), DynamicHMC.TreeStatisticsNUTS(-464.2889765876836, 3, turning at positions -1:6, 0.9750959324308438, 7, DynamicHMC.Directions(0xd39679d6)), DynamicHMC.TreeStatisticsNUTS(-464.64221785436104, 3, turning at positions -1:6, 0.9491266591655704, 7, DynamicHMC.Directions(0x24b5c31e)), DynamicHMC.TreeStatisticsNUTS(-464.7326591520337, 2, turning at positions -3:0, 0.960096429150981, 3, DynamicHMC.Directions(0xaf28927c)), DynamicHMC.TreeStatisticsNUTS(-464.76397477433255, 2, turning at positions -1:2, 0.997862854493114, 3, DynamicHMC.Directions(0x2a5f6f7e)), DynamicHMC.TreeStatisticsNUTS(-464.05688228584035, 2, turning at positions -3:0, 0.9999999999999999, 3, DynamicHMC.Directions(0xa7041898)), DynamicHMC.TreeStatisticsNUTS(-465.4612558473677, 3, turning at positions -6:1, 0.9428617168457868, 7, DynamicHMC.Directions(0xc3165ea9)), DynamicHMC.TreeStatisticsNUTS(-464.67054538869047, 2, turning at positions -2:1, 0.9809831896356619, 3, DynamicHMC.Directions(0xb5476869)), DynamicHMC.TreeStatisticsNUTS(-464.8903974085777, 2, turning at positions 4:5, 0.9879795801761446, 5, DynamicHMC.Directions(0xb2d41e97)), DynamicHMC.TreeStatisticsNUTS(-466.0388324576137, 3, turning at positions -2:5, 0.7939027137746477, 7, DynamicHMC.Directions(0x444636ad))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.07954482455039247, 0.13242173661567372], ϵ = 0.6854283845627437)
 (posterior_matrix = [0.9726213795307803 0.9129030446958983 … 0.7871260836870124 0.8442118435188307; 1.865495584528211 1.782763328754385 … 1.5218270109784324 1.919663278847679], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-465.06151039261, 1, turning at positions -2:-3, 0.9241828495595046, 3, DynamicHMC.Directions(0x5ff22c58)), DynamicHMC.TreeStatisticsNUTS(-464.51473267943317, 2, turning at positions -2:1, 0.9943824992224192, 3, DynamicHMC.Directions(0x53655481)), DynamicHMC.TreeStatisticsNUTS(-465.04922689367453, 1, turning at positions 2:3, 0.9224611609741489, 3, DynamicHMC.Directions(0x5d85fecb)), DynamicHMC.TreeStatisticsNUTS(-464.968575182249, 2, turning at positions -4:-7, 0.9232616345598501, 7, DynamicHMC.Directions(0xe68acbd8)), DynamicHMC.TreeStatisticsNUTS(-465.1805495801895, 2, turning at positions -1:2, 0.8624577350335555, 3, DynamicHMC.Directions(0x2e45c49a)), DynamicHMC.TreeStatisticsNUTS(-465.76153546251163, 2, turning at positions 2:5, 0.9919515633657168, 7, DynamicHMC.Directions(0x0b98febd)), DynamicHMC.TreeStatisticsNUTS(-466.11784336267976, 2, turning at positions 0:3, 0.8957988221066913, 3, DynamicHMC.Directions(0x9e1b5c4b)), DynamicHMC.TreeStatisticsNUTS(-465.32013281038587, 1, turning at positions -2:-3, 0.975071840881483, 3, DynamicHMC.Directions(0xdef016d4)), DynamicHMC.TreeStatisticsNUTS(-464.81199923478283, 2, turning at positions 0:3, 0.9257665841185593, 3, DynamicHMC.Directions(0x827bbd0b)), DynamicHMC.TreeStatisticsNUTS(-464.9486235002072, 2, turning at positions -3:-6, 0.9925741455224653, 7, DynamicHMC.Directions(0xc0648161))  …  DynamicHMC.TreeStatisticsNUTS(-465.7364247731463, 2, turning at positions 0:3, 0.9072983592760417, 3, DynamicHMC.Directions(0xc9e5f6af)), DynamicHMC.TreeStatisticsNUTS(-467.16011762447243, 1, turning at positions 1:2, 0.8801242402280011, 3, DynamicHMC.Directions(0x20001b9a)), DynamicHMC.TreeStatisticsNUTS(-464.67399559436467, 2, turning at positions -3:0, 0.9708667745437549, 3, DynamicHMC.Directions(0xdd3e87bc)), DynamicHMC.TreeStatisticsNUTS(-468.90844626866675, 2, turning at positions 0:3, 0.6637823400526623, 3, DynamicHMC.Directions(0x2d18409f)), DynamicHMC.TreeStatisticsNUTS(-467.00329369362146, 2, turning at positions 4:5, 0.9790648880513857, 5, DynamicHMC.Directions(0x8d759f87)), DynamicHMC.TreeStatisticsNUTS(-464.6122545516752, 3, turning at positions -1:6, 0.9988568620336602, 7, DynamicHMC.Directions(0x4de162ce)), DynamicHMC.TreeStatisticsNUTS(-464.3717062000086, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x4372cd62)), DynamicHMC.TreeStatisticsNUTS(-464.1243220688197, 2, turning at positions 0:3, 0.9778021098806629, 3, DynamicHMC.Directions(0x6e1b1973)), DynamicHMC.TreeStatisticsNUTS(-467.1978623487277, 2, turning at positions -2:-5, 0.8288618100386608, 7, DynamicHMC.Directions(0x1ed26ee2)), DynamicHMC.TreeStatisticsNUTS(-467.12837707505327, 2, turning at positions -3:0, 0.9999999999999999, 3, DynamicHMC.Directions(0x046dc6b8))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08891919344695222, 0.1337495269437607], ϵ = 0.7085266951545633)
 (posterior_matrix = [0.875259338867308 0.9627358353923812 … 0.8110033751607658 0.7010957944466804; 1.794149742507926 1.9215329986050542 … 1.7826753899263266 1.5502361395172968], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-464.26103832323906, 2, turning at positions -2:1, 0.9918426673561486, 3, DynamicHMC.Directions(0x20ad3bcd)), DynamicHMC.TreeStatisticsNUTS(-464.8581962054155, 2, turning at positions 0:3, 0.9015670264717205, 3, DynamicHMC.Directions(0xbdff6903)), DynamicHMC.TreeStatisticsNUTS(-464.5377123148083, 3, turning at positions -4:3, 0.9999999999999999, 7, DynamicHMC.Directions(0x06ec3dd3)), DynamicHMC.TreeStatisticsNUTS(-465.6466253936915, 3, turning at positions -5:2, 0.9391214978159891, 7, DynamicHMC.Directions(0xfdea892a)), DynamicHMC.TreeStatisticsNUTS(-466.104109325558, 1, turning at positions 1:2, 0.954367335976948, 3, DynamicHMC.Directions(0xe2a3b1d2)), DynamicHMC.TreeStatisticsNUTS(-465.3472012487582, 3, turning at positions -5:2, 0.8360509608363101, 7, DynamicHMC.Directions(0x2ef2cc0a)), DynamicHMC.TreeStatisticsNUTS(-465.0671487284064, 1, turning at positions -1:0, 0.8657090900454216, 1, DynamicHMC.Directions(0x2c728558)), DynamicHMC.TreeStatisticsNUTS(-464.92348743548473, 3, turning at positions -6:1, 0.986108408973549, 7, DynamicHMC.Directions(0xebb98d91)), DynamicHMC.TreeStatisticsNUTS(-464.59117365747915, 1, turning at positions -1:-2, 0.9277931969080736, 3, DynamicHMC.Directions(0xd0944ef9)), DynamicHMC.TreeStatisticsNUTS(-464.51690753127576, 2, turning at positions -3:0, 0.970534023420423, 3, DynamicHMC.Directions(0x53af5b0c))  …  DynamicHMC.TreeStatisticsNUTS(-464.71156835732234, 2, turning at positions -1:2, 0.9960487687900627, 3, DynamicHMC.Directions(0xebc222ea)), DynamicHMC.TreeStatisticsNUTS(-465.2259820846438, 2, turning at positions -3:0, 0.86637893086171, 3, DynamicHMC.Directions(0x989e9814)), DynamicHMC.TreeStatisticsNUTS(-466.43600355462866, 2, turning at positions 0:3, 0.8975513358151187, 3, DynamicHMC.Directions(0xaff1b5ef)), DynamicHMC.TreeStatisticsNUTS(-465.8007993751137, 2, turning at positions -1:2, 0.9014503941182425, 3, DynamicHMC.Directions(0x93c6b9ae)), DynamicHMC.TreeStatisticsNUTS(-464.325221687895, 2, turning at positions 0:3, 0.9941732049609296, 3, DynamicHMC.Directions(0x8f286f8b)), DynamicHMC.TreeStatisticsNUTS(-464.8030393510064, 2, turning at positions -3:0, 0.9284051106239861, 3, DynamicHMC.Directions(0xa346cab0)), DynamicHMC.TreeStatisticsNUTS(-465.2387628459887, 2, turning at positions -1:2, 0.9043365265944585, 3, DynamicHMC.Directions(0x2d45e102)), DynamicHMC.TreeStatisticsNUTS(-465.44643983394195, 1, turning at positions 0:1, 0.8675533130691987, 1, DynamicHMC.Directions(0xbb8126b3)), DynamicHMC.TreeStatisticsNUTS(-464.89628252393334, 2, turning at positions 0:3, 0.9999999999999999, 3, DynamicHMC.Directions(0x565286ab)), DynamicHMC.TreeStatisticsNUTS(-467.807324571029, 2, turning at positions -1:2, 0.7693312756783212, 3, DynamicHMC.Directions(0x8a269416))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08866951200394553, 0.11893760647820273], ϵ = 0.8180224358553879)</code></pre><p>Extract the posterior. (Here the transformation was not really necessary).</p><pre><code class="language-julia hljs">β_posterior = first.(transform.(t, eachcol(pool_posterior_matrices(results))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5000-element Vector{Vector{Float64}}:
 [0.8957306840736181, 1.7892514908542854]
 [0.965596072543925, 1.9886337937277225]
 [1.0278390951805045, 1.8338760228906419]
 [1.0093525426036327, 1.977415966828835]
 [0.9341581162944724, 1.9911179609721963]
 [0.9244755274928191, 1.9854289043115725]
 [0.878714330617721, 1.728778247610655]
 [0.8891992117905404, 1.7775936647849542]
 [1.0227891779903657, 1.9580130364018815]
 [0.838049634562683, 1.8962592161139096]
 ⋮
 [0.8271123012634926, 1.9313888732764664]
 [0.9029010717772942, 1.6227912331990564]
 [0.8122659079465145, 1.7705150605345183]
 [0.8797319030193684, 1.8296485473369315]
 [0.821399036896186, 1.6750347476328769]
 [0.8922246354111327, 1.6473667857981429]
 [0.8922246354111327, 1.6473667857981429]
 [0.8110033751607658, 1.7826753899263266]
 [0.7010957944466804, 1.5502361395172968]</code></pre><p>Check that we recover the parameters.</p><pre><code class="language-julia hljs">mean(β_posterior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.8860842152062917
 1.812595627824888</code></pre><p>Quantiles</p><pre><code class="language-julia hljs">qs = [0.05, 0.25, 0.5, 0.75, 0.95]
quantile(first.(β_posterior), qs)

quantile(last.(β_posterior), qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.6139820015058606
 1.7279781684219557
 1.8124116295151396
 1.8948617756922683
 2.015777228076106</code></pre><p>Check that mixing is good.</p><pre><code class="language-julia hljs">ess, R̂ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([2862.815578402936, 2893.2499791245677], [1.0003310499490725, 1.0013965263375868])</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_linear_regression/">« Linear regression</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 2 September 2022 12:03">Friday 2 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
