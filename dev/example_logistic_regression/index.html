<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Logistic regression · DynamicHMCExamples.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DynamicHMCExamples.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../example_independent_bernoulli/">Estimate Bernoulli draws probabilility</a></li><li><a class="tocitem" href="../example_linear_regression/">Linear regression</a></li><li class="is-active"><a class="tocitem" href>Logistic regression</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Logistic regression</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Logistic regression</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tpapp/DynamicHMCExamples.jl/blob/master/src/example_logistic_regression.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Logistic-regression"><a class="docs-heading-anchor" href="#Logistic-regression">Logistic regression</a><a id="Logistic-regression-1"></a><a class="docs-heading-anchor-permalink" href="#Logistic-regression" title="Permalink"></a></h1><p>First, we import DynamicHMC and related libraries,</p><pre><code class="language-julia hljs">using TransformVariables, LogDensityProblems, DynamicHMC, TransformedLogDensities</code></pre><p>then some packages that help code the log posterior,</p><pre><code class="language-julia hljs">using Parameters, Statistics, Random, Distributions, LinearAlgebra, StatsFuns, LogExpFunctions</code></pre><p>then diagnostic and benchmark tools,</p><pre><code class="language-julia hljs">using MCMCDiagnosticTools, BenchmarkTools</code></pre><p>and use ForwardDiff for AD since the dimensions is small.</p><pre><code class="language-julia hljs">import ForwardDiff

&quot;&quot;&quot;
Logistic regression.

For each draw, ``logit(Pr(yᵢ == 1)) ∼ Xᵢ β``. Uses a `β ∼ Normal(0, σ)` prior.

`X` is supposed to include the `1`s for the intercept.
&quot;&quot;&quot;
struct LogisticRegression{Ty, TX, Tσ}
    y::Ty
    X::TX
    σ::Tσ
end

function (problem::LogisticRegression)(θ)
    @unpack y, X, σ = problem
    @unpack β = θ
    ℓ_y = mapreduce((y, x) -&gt; logpdf(Bernoulli(logistic(dot(x, β))), y), +, y, eachrow(X))
    ℓ_β =  loglikelihood(Normal(0, σ), β)
    ℓ_y + ℓ_β
end</code></pre><p>Make up parameters, generate data using random draws.</p><pre><code class="language-julia hljs">N = 1000
β = [1.0, 2.0]
X = hcat(ones(N), randn(N))
y = rand.(Bernoulli.(logistic.(X*β)));</code></pre><p>Create a problem, apply a transformation, then use automatic differentiation.</p><pre><code class="language-julia hljs">p = LogisticRegression(y, X, 10.0)   # data and (vague) priors
t = as((β = as(Array, length(β)), )) # identity transformation, just to get the dimension
P = TransformedLogDensity(t, p)      # transformed
∇P = ADgradient(:ForwardDiff, P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ForwardDiff AD wrapper for TransformedLogDensity of dimension 2, w/ chunk size 2</code></pre><p>Benchmark</p><pre><code class="language-julia hljs">@btime p((β = $β,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-437.6366937188787</code></pre><p>Sample using NUTS, random starting point.</p><pre><code class="language-julia hljs">results = map(_ -&gt; mcmc_with_warmup(Random.default_rng(), ∇P, 1000), 1:5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{NamedTuple{(:posterior_matrix, :tree_statistics, :κ, :ϵ), Tuple{Matrix{Float64}, Vector{DynamicHMC.TreeStatisticsNUTS}, DynamicHMC.GaussianKineticEnergy{LinearAlgebra.Diagonal{Float64, Vector{Float64}}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}}, Float64}}}:
 (posterior_matrix = [0.977831410163123 1.027296899394362 … 0.9673202594912009 1.0976019830902073; 2.0772725180478098 2.0361220622960694 … 2.253034254912726 2.152085502888519], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-437.83268858838625, 2, turning at positions -1:2, 0.9961021140695953, 3, DynamicHMC.Directions(0x5840cf4e)), DynamicHMC.TreeStatisticsNUTS(-439.2436296496386, 2, turning at positions 0:3, 0.7869247247893735, 3, DynamicHMC.Directions(0x7e10b89b)), DynamicHMC.TreeStatisticsNUTS(-438.38866484763014, 2, turning at positions 0:3, 0.9226385098627886, 3, DynamicHMC.Directions(0x2dddea7b)), DynamicHMC.TreeStatisticsNUTS(-439.68126970004863, 2, turning at positions -3:0, 0.8238198713820379, 3, DynamicHMC.Directions(0x5e71d7c8)), DynamicHMC.TreeStatisticsNUTS(-439.724938813169, 2, turning at positions -1:2, 0.9452182095472793, 3, DynamicHMC.Directions(0x63173142)), DynamicHMC.TreeStatisticsNUTS(-439.07210450871844, 1, turning at positions 1:2, 0.7177172464951799, 3, DynamicHMC.Directions(0x278f5dd6)), DynamicHMC.TreeStatisticsNUTS(-439.1004838058776, 1, turning at positions -1:-2, 0.6782825496275344, 3, DynamicHMC.Directions(0xbb1de0f1)), DynamicHMC.TreeStatisticsNUTS(-438.39649439239616, 1, turning at positions -1:-2, 0.8626938117174854, 3, DynamicHMC.Directions(0x15fc533d)), DynamicHMC.TreeStatisticsNUTS(-440.03757663662634, 2, turning at positions 2:5, 0.8866600987988031, 7, DynamicHMC.Directions(0x3d66d69d)), DynamicHMC.TreeStatisticsNUTS(-438.88300961708893, 2, turning at positions 4:5, 0.8935776215880704, 5, DynamicHMC.Directions(0x7e5e2a6f))  …  DynamicHMC.TreeStatisticsNUTS(-444.99573466972623, 2, turning at positions 0:3, 0.7817806513968178, 3, DynamicHMC.Directions(0xf2e6df17)), DynamicHMC.TreeStatisticsNUTS(-438.83823325015857, 2, turning at positions -3:-6, 0.8935036514450287, 7, DynamicHMC.Directions(0x4ef38011)), DynamicHMC.TreeStatisticsNUTS(-440.90434547522955, 2, turning at positions 0:3, 0.8161621162818896, 3, DynamicHMC.Directions(0x69db0837)), DynamicHMC.TreeStatisticsNUTS(-438.6810242240223, 2, turning at positions -2:1, 0.9892713526511159, 3, DynamicHMC.Directions(0x2c372d91)), DynamicHMC.TreeStatisticsNUTS(-439.95482328778843, 1, turning at positions -1:0, 0.6920493644716958, 1, DynamicHMC.Directions(0x05ca6df4)), DynamicHMC.TreeStatisticsNUTS(-440.4095902564504, 3, turning at positions -5:2, 0.9846199817618538, 7, DynamicHMC.Directions(0x1596174a)), DynamicHMC.TreeStatisticsNUTS(-437.95123262016233, 2, turning at positions 0:3, 0.9991795465568892, 3, DynamicHMC.Directions(0xaa72433f)), DynamicHMC.TreeStatisticsNUTS(-438.60506729301534, 2, turning at positions -3:0, 0.9268930417328631, 3, DynamicHMC.Directions(0x3a4165ec)), DynamicHMC.TreeStatisticsNUTS(-439.5519514673721, 2, turning at positions -1:2, 0.9363567882977352, 3, DynamicHMC.Directions(0xa3623d0e)), DynamicHMC.TreeStatisticsNUTS(-439.5091800344213, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xd2ddd962))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.0988465997773048, 0.13444556554824955], ϵ = 0.7549906033633258)
 (posterior_matrix = [0.8195973879326678 1.110066933779684 … 1.1031571597936334 1.0455472338967318; 2.0276009782340063 1.9090504028225646 … 2.2396635240173834 2.06557543163043], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-440.70286417471846, 2, turning at positions -3:0, 0.7361126092986544, 3, DynamicHMC.Directions(0xc0b4b44c)), DynamicHMC.TreeStatisticsNUTS(-441.14183466995144, 2, turning at positions 4:7, 0.9153092619176783, 7, DynamicHMC.Directions(0x900091ef)), DynamicHMC.TreeStatisticsNUTS(-440.3790634181415, 2, turning at positions -3:0, 0.9599392754007906, 3, DynamicHMC.Directions(0xf48e38a0)), DynamicHMC.TreeStatisticsNUTS(-439.9964399150789, 3, turning at positions 0:7, 0.9896786472532261, 7, DynamicHMC.Directions(0xde2f6b9f)), DynamicHMC.TreeStatisticsNUTS(-440.6320071399237, 2, turning at positions -3:0, 0.9157245939572446, 3, DynamicHMC.Directions(0x20721138)), DynamicHMC.TreeStatisticsNUTS(-440.97249627842893, 1, turning at positions 2:3, 0.9147006735877183, 3, DynamicHMC.Directions(0x70dc5d1f)), DynamicHMC.TreeStatisticsNUTS(-439.5746895368705, 2, turning at positions 0:3, 0.8078944586539922, 3, DynamicHMC.Directions(0xe8c70f77)), DynamicHMC.TreeStatisticsNUTS(-440.5253932573194, 2, turning at positions 2:3, 0.7537611050709787, 5, DynamicHMC.Directions(0x9ffd6ce5)), DynamicHMC.TreeStatisticsNUTS(-440.6027898332934, 2, turning at positions 1:4, 0.9480895668651138, 7, DynamicHMC.Directions(0x467b4544)), DynamicHMC.TreeStatisticsNUTS(-439.38597263988163, 2, turning at positions -1:2, 0.9280075208629208, 3, DynamicHMC.Directions(0x623cf046))  …  DynamicHMC.TreeStatisticsNUTS(-439.2361682331801, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x9b6a05b7)), DynamicHMC.TreeStatisticsNUTS(-440.4806364536285, 3, turning at positions -6:1, 0.9651845260591594, 7, DynamicHMC.Directions(0xeb89b2b9)), DynamicHMC.TreeStatisticsNUTS(-441.0854882714327, 2, turning at positions -2:1, 0.961540051567305, 3, DynamicHMC.Directions(0x4164489d)), DynamicHMC.TreeStatisticsNUTS(-439.06837472887685, 2, turning at positions -4:-5, 0.9802938240508109, 7, DynamicHMC.Directions(0x720aa462)), DynamicHMC.TreeStatisticsNUTS(-441.63413397642654, 2, turning at positions -3:-6, 0.7504989084538448, 7, DynamicHMC.Directions(0xd1bbc829)), DynamicHMC.TreeStatisticsNUTS(-440.4276919699816, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xbd58c122)), DynamicHMC.TreeStatisticsNUTS(-439.0164232354041, 2, turning at positions -6:-7, 0.9782379607854674, 7, DynamicHMC.Directions(0x686d6020)), DynamicHMC.TreeStatisticsNUTS(-438.7049801197096, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x6f537f36)), DynamicHMC.TreeStatisticsNUTS(-438.93297672525745, 3, turning at positions -7:0, 0.9746479274363836, 7, DynamicHMC.Directions(0xcb84e488)), DynamicHMC.TreeStatisticsNUTS(-440.19794582730805, 1, turning at positions 1:2, 0.9370591873105836, 3, DynamicHMC.Directions(0xb469326e))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.08907794812617117, 0.14191732750971864], ϵ = 0.6580288542591857)
 (posterior_matrix = [0.9888748328482421 0.9380055694115754 … 1.0073666412045128 0.8904586080050828; 2.0552765137528377 1.8473186044608816 … 2.10955037347421 1.991603009658282], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-437.9652608426835, 1, turning at positions -1:-2, 0.9839908676863134, 3, DynamicHMC.Directions(0x68aae719)), DynamicHMC.TreeStatisticsNUTS(-438.7393783126124, 2, turning at positions -3:0, 0.9312460369563581, 3, DynamicHMC.Directions(0xbc8c2cc4)), DynamicHMC.TreeStatisticsNUTS(-439.18080713288055, 2, turning at positions -2:1, 0.9658251251943238, 3, DynamicHMC.Directions(0x08351141)), DynamicHMC.TreeStatisticsNUTS(-440.31277057443646, 2, turning at positions 4:5, 0.9042853021798806, 5, DynamicHMC.Directions(0xbd23109f)), DynamicHMC.TreeStatisticsNUTS(-438.31638787284186, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xd93ff1ca)), DynamicHMC.TreeStatisticsNUTS(-437.88886943837775, 2, turning at positions -3:0, 0.9712306075078577, 3, DynamicHMC.Directions(0x2132a650)), DynamicHMC.TreeStatisticsNUTS(-437.8231458498076, 3, turning at positions -5:2, 0.9805363382529519, 7, DynamicHMC.Directions(0x49f28712)), DynamicHMC.TreeStatisticsNUTS(-438.04493193823447, 2, turning at positions 0:3, 0.9939207315269557, 3, DynamicHMC.Directions(0xd6aa7357)), DynamicHMC.TreeStatisticsNUTS(-438.2601085040176, 2, turning at positions -2:1, 0.9843054614055391, 3, DynamicHMC.Directions(0x61ef5f85)), DynamicHMC.TreeStatisticsNUTS(-439.476357979306, 2, turning at positions -4:-7, 0.9385887408825572, 7, DynamicHMC.Directions(0x377fca68))  …  DynamicHMC.TreeStatisticsNUTS(-439.06889149422113, 2, turning at positions 2:5, 0.9019931024597864, 7, DynamicHMC.Directions(0x625215f5)), DynamicHMC.TreeStatisticsNUTS(-439.72015261208713, 2, turning at positions -5:-6, 0.8252908365129988, 7, DynamicHMC.Directions(0xccb6b5f9)), DynamicHMC.TreeStatisticsNUTS(-439.6491547909937, 2, turning at positions -2:1, 0.9999999999999999, 3, DynamicHMC.Directions(0x8126e31d)), DynamicHMC.TreeStatisticsNUTS(-439.57479108253926, 1, turning at positions 2:3, 0.9597405744868225, 3, DynamicHMC.Directions(0x26a8ce4b)), DynamicHMC.TreeStatisticsNUTS(-438.1917154195495, 2, turning at positions -1:2, 0.9534901533487967, 3, DynamicHMC.Directions(0x602c350e)), DynamicHMC.TreeStatisticsNUTS(-438.01024624574603, 2, turning at positions -3:-4, 0.9999999999999999, 7, DynamicHMC.Directions(0xd11661cb)), DynamicHMC.TreeStatisticsNUTS(-438.38015344708134, 2, turning at positions -1:2, 0.9265597108785247, 3, DynamicHMC.Directions(0xeefbc6d2)), DynamicHMC.TreeStatisticsNUTS(-440.0503751062374, 2, turning at positions -2:-5, 0.9487937356640161, 7, DynamicHMC.Directions(0xb2cccf7a)), DynamicHMC.TreeStatisticsNUTS(-438.86249217286195, 2, turning at positions 4:7, 0.9999999999999999, 7, DynamicHMC.Directions(0x087a4b77)), DynamicHMC.TreeStatisticsNUTS(-438.93851682902323, 3, turning at positions -7:0, 0.9580788289380412, 7, DynamicHMC.Directions(0x3f02da48))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09478617807572394, 0.13236837275678712], ϵ = 0.6663516824630605)
 (posterior_matrix = [0.7624214128178286 0.774770099162353 … 1.0086283820591375 0.9199936566919655; 1.7453511650899232 1.7650724198231016 … 2.164829026673245 2.2174337393275367], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-441.99162577871493, 3, turning at positions -4:3, 0.9997136974788612, 7, DynamicHMC.Directions(0x7efc9edb)), DynamicHMC.TreeStatisticsNUTS(-441.719467926702, 1, turning at positions 0:1, 1.0, 1, DynamicHMC.Directions(0x00546689)), DynamicHMC.TreeStatisticsNUTS(-442.4239637642965, 3, turning at positions -4:3, 0.9770598060866966, 7, DynamicHMC.Directions(0x962c6d3b)), DynamicHMC.TreeStatisticsNUTS(-443.41329178393005, 3, turning at positions -4:3, 0.9956823080729608, 7, DynamicHMC.Directions(0x60440073)), DynamicHMC.TreeStatisticsNUTS(-443.3362081534526, 1, turning at positions -1:0, 1.0, 1, DynamicHMC.Directions(0xc8141386)), DynamicHMC.TreeStatisticsNUTS(-443.1494276553646, 2, turning at positions -1:2, 0.9950462262899978, 3, DynamicHMC.Directions(0xa10314d2)), DynamicHMC.TreeStatisticsNUTS(-443.2418032248522, 2, turning at positions -4:-7, 0.7099762100008199, 7, DynamicHMC.Directions(0xefba5900)), DynamicHMC.TreeStatisticsNUTS(-442.7320047389179, 2, turning at positions -3:-6, 0.9930284808545468, 7, DynamicHMC.Directions(0xd5c87651)), DynamicHMC.TreeStatisticsNUTS(-439.0189763881763, 2, turning at positions 4:7, 0.9973317313013481, 7, DynamicHMC.Directions(0x6b9df0ef)), DynamicHMC.TreeStatisticsNUTS(-442.61845711393636, 2, turning at positions 0:3, 0.6285057871473331, 3, DynamicHMC.Directions(0x5d431867))  …  DynamicHMC.TreeStatisticsNUTS(-439.31067019804306, 2, turning at positions -2:1, 0.9249645967255072, 3, DynamicHMC.Directions(0xc4295c0d)), DynamicHMC.TreeStatisticsNUTS(-438.94941548260437, 2, turning at positions 0:3, 0.9755777282548806, 3, DynamicHMC.Directions(0xe8faae17)), DynamicHMC.TreeStatisticsNUTS(-438.53316337403356, 2, turning at positions -3:0, 0.9968052325482125, 3, DynamicHMC.Directions(0x9f900f14)), DynamicHMC.TreeStatisticsNUTS(-439.6072927526651, 3, turning at positions -6:1, 0.9446691622488607, 7, DynamicHMC.Directions(0x51777519)), DynamicHMC.TreeStatisticsNUTS(-438.82183435539815, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0x819f109a)), DynamicHMC.TreeStatisticsNUTS(-438.5164002665628, 1, turning at positions 2:3, 0.9519183857085419, 3, DynamicHMC.Directions(0xe3421507)), DynamicHMC.TreeStatisticsNUTS(-437.9949429700887, 2, turning at positions 4:7, 0.9989142183267851, 7, DynamicHMC.Directions(0x17c0c377)), DynamicHMC.TreeStatisticsNUTS(-437.7496389813297, 2, turning at positions 3:6, 0.9882064745969403, 7, DynamicHMC.Directions(0xd8ae7476)), DynamicHMC.TreeStatisticsNUTS(-439.32752182773993, 3, turning at positions -7:0, 0.9214611857045423, 7, DynamicHMC.Directions(0xe18e86e8)), DynamicHMC.TreeStatisticsNUTS(-439.8279903121317, 2, turning at positions -1:2, 0.7840975868867738, 3, DynamicHMC.Directions(0x307192d2))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09284330582383456, 0.138677866769178], ϵ = 0.7023297138458328)
 (posterior_matrix = [0.9868659983587018 0.9366299506128548 … 0.9372056366575142 1.107596396356338; 2.1200349285898326 2.19028901450598 … 2.0389010354256554 2.0186357304682137], tree_statistics = [DynamicHMC.TreeStatisticsNUTS(-437.93294639400364, 2, turning at positions 6:7, 0.9899479016838741, 7, DynamicHMC.Directions(0xa8f8535f)), DynamicHMC.TreeStatisticsNUTS(-439.119456396694, 2, turning at positions 0:3, 0.8931297636681816, 3, DynamicHMC.Directions(0xbcef10e7)), DynamicHMC.TreeStatisticsNUTS(-440.28901133459254, 3, turning at positions -3:4, 0.974061432609702, 7, DynamicHMC.Directions(0x2551fd4c)), DynamicHMC.TreeStatisticsNUTS(-441.809978971636, 3, turning at positions -6:1, 0.9459997602846306, 7, DynamicHMC.Directions(0x9d62c541)), DynamicHMC.TreeStatisticsNUTS(-437.9909305241617, 1, turning at positions -1:-2, 0.9638253006532628, 3, DynamicHMC.Directions(0xd9109a61)), DynamicHMC.TreeStatisticsNUTS(-437.9577538177413, 2, turning at positions 1:4, 0.9880194412113347, 7, DynamicHMC.Directions(0x6b74ed04)), DynamicHMC.TreeStatisticsNUTS(-439.33587697990174, 3, turning at positions -5:2, 0.8802188917875945, 7, DynamicHMC.Directions(0xa320bd22)), DynamicHMC.TreeStatisticsNUTS(-440.82745021349695, 1, turning at positions 0:1, 0.6791888074095843, 1, DynamicHMC.Directions(0x3e570a87)), DynamicHMC.TreeStatisticsNUTS(-439.1306697457468, 3, turning at positions 0:7, 0.9999999999999999, 7, DynamicHMC.Directions(0xd7894c6f)), DynamicHMC.TreeStatisticsNUTS(-439.98974202111486, 2, turning at positions -3:0, 0.8944667700620617, 3, DynamicHMC.Directions(0x9bb7e878))  …  DynamicHMC.TreeStatisticsNUTS(-438.384963935815, 2, turning at positions 2:5, 0.9881589003833583, 7, DynamicHMC.Directions(0x80efe3bd)), DynamicHMC.TreeStatisticsNUTS(-439.8058541475426, 2, turning at positions -3:-6, 0.932135547729874, 7, DynamicHMC.Directions(0x95046451)), DynamicHMC.TreeStatisticsNUTS(-439.63380937893896, 2, turning at positions -1:2, 0.9601969663511744, 3, DynamicHMC.Directions(0x35845f3e)), DynamicHMC.TreeStatisticsNUTS(-443.1145446948233, 2, turning at positions -3:0, 0.848398242935648, 3, DynamicHMC.Directions(0xd7a0bee0)), DynamicHMC.TreeStatisticsNUTS(-443.45314068707347, 2, turning at positions -1:2, 0.9567245080500085, 3, DynamicHMC.Directions(0x9a5bc96a)), DynamicHMC.TreeStatisticsNUTS(-443.5770508860711, 3, turning at positions -2:5, 0.748952169845456, 7, DynamicHMC.Directions(0xfe1c7455)), DynamicHMC.TreeStatisticsNUTS(-438.9614083747015, 3, turning at positions -1:6, 0.9838890776166094, 7, DynamicHMC.Directions(0x669bf04e)), DynamicHMC.TreeStatisticsNUTS(-438.34185698546963, 2, turning at positions -1:2, 0.9999999999999999, 3, DynamicHMC.Directions(0xb1cfd23e)), DynamicHMC.TreeStatisticsNUTS(-439.16330052221844, 1, turning at positions -1:-2, 0.9153781813497287, 3, DynamicHMC.Directions(0x692bd4a1)), DynamicHMC.TreeStatisticsNUTS(-439.17564064353365, 2, turning at positions 0:3, 0.8833346767010407, 3, DynamicHMC.Directions(0x7ed06b0f))], κ = Gaussian kinetic energy (Diagonal), √diag(M⁻¹): [0.09247570579644718, 0.13180579760426755], ϵ = 0.6388250112966452)</code></pre><p>Extract the posterior. (Here the transformation was not really necessary).</p><pre><code class="language-julia hljs">β_posterior = first.(transform.(t, eachcol(pool_posterior_matrices(results))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5000-element Vector{Vector{Float64}}:
 [0.977831410163123, 2.0772725180478098]
 [1.027296899394362, 2.0361220622960694]
 [1.0132324947009186, 2.143852546859969]
 [1.1086973381029324, 1.9443601133675616]
 [1.017578567199023, 2.0589159015317886]
 [1.017578567199023, 2.0589159015317886]
 [1.017578567199023, 2.0589159015317886]
 [0.9358149947700247, 2.1115965676313304]
 [0.9297482612179919, 1.8766440441973131]
 [1.0013429246334922, 2.1064057176636855]
 ⋮
 [1.138063222638017, 2.1767035715104774]
 [1.1773379630145795, 2.1495874874771608]
 [1.1384786270571245, 2.486346864531338]
 [1.169135240180531, 2.302012120373596]
 [0.9280035463891156, 2.05832081901276]
 [0.941813096339809, 1.868131289817422]
 [0.9516937716320144, 1.8890721545664266]
 [0.9372056366575142, 2.0389010354256554]
 [1.107596396356338, 2.0186357304682137]</code></pre><p>Check that we recover the parameters.</p><pre><code class="language-julia hljs">mean(β_posterior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.990517380294133
 2.043993090800135</code></pre><p>Quantiles</p><pre><code class="language-julia hljs">qs = [0.05, 0.25, 0.5, 0.75, 0.95]
quantile(first.(β_posterior), qs)

quantile(last.(β_posterior), qs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 1.8216919870208894
 1.9522196949638415
 2.042755441975979
 2.134791833386883
 2.266894305230337</code></pre><p>Check that mixing is good.</p><pre><code class="language-julia hljs">ess, R̂ = ess_rhat(stack_posterior_matrices(results))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([2615.1833097722597, 2390.35635895396], [0.9999468876251152, 0.9999042781946712])</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_linear_regression/">« Linear regression</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 3 September 2022 07:30">Saturday 3 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
